{"assets":{"D63C5C2DC42BCAC93596A83C0C11C541":{"type":"texture","index":0,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":1920,"height":1080},"B5A45AA906F0BB5CB074727A7B0A4916":{"type":"texture","index":2,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":499,"height":972},"991CAB28492072066D106A82EC1D505F":{"type":"texture","index":1,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":416,"height":52},"A35EAEFFF7FCB0BE3167DA336D4F5899":{"type":"texture","index":5,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":352,"height":65},"39CD108B14722F87544A959452F36B3C":{"type":"texture","index":7,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":1920,"height":1080},"9D18C555AF4B53CB4358DAAB26305BCB":{"type":"texture","index":6,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":1920,"height":1080},"F2CF5BC9921DAF75211ADE63F9F9D910":{"type":"texture","index":3,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":441,"height":964},"AB2D2B4D785DDFEC80EFE79D1E4E1EEE":{"type":"texture","index":4,"url":{"native":"assets\/4E2CE6B9-E559-4953-A586-FA38C2166255.pdf"},"width":640,"height":565}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":336.14012145996094,"pointY":618.35398864746094},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":873.35987854003906,"pointY":407.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":1.7502201974750282,"pointY":0.41938890056845585}},"layers":[{"animations":[{"additive":false,"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"fillMode":"both","duration":0.01,"autoreverses":false,"animations":[{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":true},"repeatCount":0,"fillMode":"both","duration":0.0001,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true},{"additive":false,"timeOffset":0,"beginTime":0.0001,"from":{"scalar":false},"repeatCount":0,"fillMode":"forwards","duration":0.0099000000000000008,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true}],"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":239.85987854003906,"pointY":476.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":972,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"B5A45AA906F0BB5CB074727A7B0A4916"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Dynamic Tempo","targetRectangle":{"y":53.599999904632568,"x":98.599999904632568,"width":416.68000015981499,"height":71.449998885393143}},{"text":"Beats <-> Time <-> Bars","targetRectangle":{"y":176.35398948192596,"x":1260.2998046875,"width":415.03999999999996,"height":52.599999189376831}},{"text":"Curve Calculations","targetRectangle":{"y":136.35398948192596,"x":681.8973388671875,"width":344.23999999999978,"height":52.599999189376831}},{"text":"Sequence Creation","targetRectangle":{"y":136.35398948192596,"x":90.640121459960938,"width":347.56,"height":52.599999189376831}},{"text":"inline double Sequence::calcCurveBpm (double beat, const TempoChange t1, const TempoChange t2)","targetRectangle":{"y":199.99999618530273,"x":685.824462890625,"width":338.455078125,"height":7}},{"text":"{","targetRectangle":{"y":206.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    const auto b1 = t1.startBeat.inBeats();","targetRectangle":{"y":213.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto b2 = t2.startBeat.inBeats();","targetRectangle":{"y":220.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto bpm1 = t1.bpm;","targetRectangle":{"y":227.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto bpm2 = t2.bpm;","targetRectangle":{"y":234.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto c = t1.curve;","targetRectangle":{"y":241.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    const auto [x, y] = getBezierPoint (b1, bpm1, b2, bpm2, c);","targetRectangle":{"y":255.99999618530273,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    if (c >= -0.5 && c <= 0.5)","targetRectangle":{"y":269.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"        return getBezierYFromX (beat,","targetRectangle":{"y":276.99999618530273,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"                                b1, bpm1, x, y, b2, bpm2);","targetRectangle":{"y":283.99999618530273,"x":685.824462890625,"width":208.833984375,"height":7}},{"text":"    double x1end = 0;","targetRectangle":{"y":297.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double x2end = 0;","targetRectangle":{"y":304.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y1end = 0;","targetRectangle":{"y":311.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y2end = 0;","targetRectangle":{"y":318.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    getBezierEnds (b1, bpm1, b2, bpm2, c,","targetRectangle":{"y":332.99999618530273,"x":685.824462890625,"width":147.6240234375,"height":7}},{"text":"                   x1end, y1end, x2end, y2end);","targetRectangle":{"y":339.99999618530273,"x":685.824462890625,"width":169.2275390625,"height":7}},{"text":"    if (beat >= b1 && beat <= x1end)","targetRectangle":{"y":353.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y1end;","targetRectangle":{"y":360.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    if (beat >= x2end && beat <= b2)","targetRectangle":{"y":374.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y2end;","targetRectangle":{"y":381.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    return getBezierYFromX (beat, x1end, y1end, x, y, x2end, y2end);","targetRectangle":{"y":395.99999618530273,"x":685.824462890625,"width":244.83984375,"height":7}},{"text":"}","targetRectangle":{"y":402.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline std::pair<double \/*x*\/, double \/*y*\/> getBezierPoint (double x1, double y1, double x2, double y2,","targetRectangle":{"y":416.99999618530273,"x":685.824462890625,"width":374.4609375,"height":7}},{"text":"                                                             double c) noexcept","targetRectangle":{"y":423.99999618530273,"x":685.824462890625,"width":284.4462890625,"height":7}},{"text":"{","targetRectangle":{"y":430.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    if (y2 > y1)","targetRectangle":{"y":437.99999618530273,"x":685.824462890625,"width":57.609375,"height":7}},{"text":"    {","targetRectangle":{"y":444.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        auto run  = x2 - x1;","targetRectangle":{"y":451.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto rise = y2 - y1;","targetRectangle":{"y":458.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto xc = x1 + run \/ 2;","targetRectangle":{"y":472.99999618530273,"x":685.824462890625,"width":111.6181640625,"height":7}},{"text":"        auto yc = y1 + rise \/ 2;","targetRectangle":{"y":479.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"        auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":493.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        auto y = yc + rise \/ 2 * -c;","targetRectangle":{"y":500.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return { x, y };","targetRectangle":{"y":514.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    }","targetRectangle":{"y":521.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    auto run  = x2 - x1;","targetRectangle":{"y":535.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto rise = y1 - y2;","targetRectangle":{"y":542.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto xc = x1 + run \/ 2;","targetRectangle":{"y":556.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    auto yc = y2 + rise \/ 2;","targetRectangle":{"y":563.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":577.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    auto y = yc - rise \/ 2 * -c;","targetRectangle":{"y":584.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    return { x, y };","targetRectangle":{"y":598.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"}","targetRectangle":{"y":605.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline void getBezierEnds (const double x1, const double y1, const double x2, const double y2, const double c,","targetRectangle":{"y":619.99999618530273,"x":685.824462890625,"width":396.064453125,"height":7}},{"text":"                           double& x1out, double& y1out, double& x2out, double& y2out) noexcept","targetRectangle":{"y":626.99999618530273,"x":685.824462890625,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":633.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    auto minic = (std::abs (c) - 0.5f) * 2.0f;","targetRectangle":{"y":640.99999618530273,"x":685.824462890625,"width":165.626953125,"height":7}},{"text":"    auto run   = minic * (x2 - x1);","targetRectangle":{"y":647.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    auto rise  = minic * ((y2 > y1) ? (y2 - y1) : (y1 - y2));","targetRectangle":{"y":654.99999618530273,"x":685.824462890625,"width":219.6357421875,"height":7}},{"text":"    if (c > 0)","targetRectangle":{"y":668.99999618530273,"x":685.824462890625,"width":50.408203125,"height":7}},{"text":"    {","targetRectangle":{"y":675.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1 + run;","targetRectangle":{"y":682.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y1out = (float) y1;","targetRectangle":{"y":689.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"        x2out = x2;","targetRectangle":{"y":703.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y2out = (float) (y1 < y2 ? (y2 - rise) : (y2 + rise));","targetRectangle":{"y":710.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"    }","targetRectangle":{"y":717.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":724.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":731.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1;","targetRectangle":{"y":738.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y1out = (float) (y1 < y2 ? (y1 + rise) : (y1 - rise));","targetRectangle":{"y":745.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"        x2out = x2 - run;","targetRectangle":{"y":759.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y2out = (float) y2;","targetRectangle":{"y":766.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    }","targetRectangle":{"y":773.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"}","targetRectangle":{"y":780.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline double getBezierYFromX (double x, double x1, double y1, double xb, double yb, double x2, double y2) noexcept","targetRectangle":{"y":794.99999618530273,"x":685.824462890625,"width":414.0673828125,"height":7}},{"text":"{","targetRectangle":{"y":801.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    \/\/ test for straight lines and bail out","targetRectangle":{"y":808.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    if (x1 == x2 || y1 == y2)","targetRectangle":{"y":815.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"        return y1;","targetRectangle":{"y":822.99999618530273,"x":685.824462890625,"width":64.810546875,"height":7}},{"text":"    \/\/ test for endpoints","targetRectangle":{"y":836.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"    if (x <= x1)  return y1;","targetRectangle":{"y":843.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    if (x >= x2)  return y2;","targetRectangle":{"y":850.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    \/\/ ok, we have a bezier curve with one control point,","targetRectangle":{"y":864.99999618530273,"x":685.824462890625,"width":205.2333984375,"height":7}},{"text":"    \/\/ we know x, we need to find y","targetRectangle":{"y":871.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    \/\/ flip the bezier equation around so its an quadratic equation","targetRectangle":{"y":885.99999618530273,"x":685.824462890625,"width":241.2392578125,"height":7}},{"text":"    auto a = x1 - 2 * xb + x2;","targetRectangle":{"y":892.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto b = -2 * x1 + 2 * xb;","targetRectangle":{"y":899.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto c = x1 - x;","targetRectangle":{"y":906.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"    \/\/ solve for t, [0..1]","targetRectangle":{"y":920.99999618530273,"x":685.824462890625,"width":93.615234375,"height":7}},{"text":"    double t;","targetRectangle":{"y":927.99999618530273,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"    if (a == 0)","targetRectangle":{"y":941.99999618530273,"x":685.824462890625,"width":54.0087890625,"height":7}},{"text":"    {","targetRectangle":{"y":948.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = -c \/ b;","targetRectangle":{"y":955.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"    }","targetRectangle":{"y":962.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":969.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":976.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = (-b + std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":983.99999618530273,"x":685.824462890625,"width":212.4345703125,"height":7}},{"text":"        if (t < 0.0f || t > 1.0f)","targetRectangle":{"y":997.99999618530273,"x":685.824462890625,"width":118.8193359375,"height":7}},{"text":"            t = (-b - std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":1004.9999961853027,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    }","targetRectangle":{"y":1011.9999961853027,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    jassert (t >= 0.0f && t <= 1.0f);","targetRectangle":{"y":1025.9999961853027,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"    \/\/ find y using the t we just found","targetRectangle":{"y":1039.9999961853027,"x":685.824462890625,"width":140.4228515625,"height":7}},{"text":"    auto y = (std::pow (1 - t, 2) * y1) + 2 * t * (1 - t) * yb + std::pow (t, 2) * y2;","targetRectangle":{"y":1046.9999961853027,"x":685.824462890625,"width":309.650390625,"height":7}},{"text":"    return y;","targetRectangle":{"y":1053.9999961853027,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"}","targetRectangle":{"y":1060.9999961853027,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline BeatPosition toBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":239.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":246.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i > 0;)","targetRectangle":{"y":253.99999237060547,"x":1262.2669677734375,"width":176.4287109375,"height":7}},{"text":"    {","targetRectangle":{"y":260.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":267.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time)","targetRectangle":{"y":281.99999237060547,"x":1262.2669677734375,"width":118.8193359375,"height":7}},{"text":"            return it.startBeat + (time - it.startTime) * it.beatsPerSecond;","targetRectangle":{"y":288.99999237060547,"x":1262.2669677734375,"width":273.64453125,"height":7}},{"text":"    }","targetRectangle":{"y":295.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":309.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startBeat + ((time - it.startTime) * it.beatsPerSecond);","targetRectangle":{"y":316.99999237060547,"x":1262.2669677734375,"width":252.041015625,"height":7}},{"text":"}","targetRectangle":{"y":323.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BeatPosition beats)","targetRectangle":{"y":337.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":344.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":351.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":358.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":365.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (toPosition (beats - it.startBeat) >= BeatPosition())","targetRectangle":{"y":379.99999237060547,"x":1262.2669677734375,"width":230.4375,"height":7}},{"text":"            return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":386.99999237060547,"x":1262.2669677734375,"width":277.2451171875,"height":7}},{"text":"    }","targetRectangle":{"y":393.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":407.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":414.99999237060547,"x":1262.2669677734375,"width":248.4404296875,"height":7}},{"text":"}","targetRectangle":{"y":421.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BarsAndBeats barsBeats)","targetRectangle":{"y":435.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"{","targetRectangle":{"y":442.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":449.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":456.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        const auto& it = sections[(size_t) i];","targetRectangle":{"y":463.99999237060547,"x":1262.2669677734375,"width":165.626953125,"height":7}},{"text":"        if (it.barNumberOfFirstBar == barsBeats.bars + 1","targetRectangle":{"y":477.99999237060547,"x":1262.2669677734375,"width":201.6328125,"height":7}},{"text":"              && barsBeats.beats.inBeats() >= it.prevNumerator - it.beatsUntilFirstBar.inBeats())","targetRectangle":{"y":484.99999237060547,"x":1262.2669677734375,"width":349.2568359375,"height":7}},{"text":"            return it.timeOfFirstBar - it.secondsPerBeat * (BeatDuration::fromBeats (it.prevNumerator) - barsBeats.beats);","targetRectangle":{"y":491.99999237060547,"x":1262.2669677734375,"width":439.271484375,"height":7}},{"text":"        if (it.barNumberOfFirstBar <= barsBeats.bars || i == 0)","targetRectangle":{"y":505.99999237060547,"x":1262.2669677734375,"width":226.8369140625,"height":7}},{"text":"            return it.timeOfFirstBar + it.secondsPerBeat * (BeatDuration::fromBeats (((barsBeats.bars - it.barNumberOfFirstBar) * it.numerator)) + barsBeats.beats);","targetRectangle":{"y":512.99999237060547,"x":1262.2669677734375,"width":590.49609375,"height":7}},{"text":"    }","targetRectangle":{"y":519.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return {};","targetRectangle":{"y":533.99999237060547,"x":1262.2669677734375,"width":50.408203125,"height":7}},{"text":"}","targetRectangle":{"y":540.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline BarsAndBeats toBarsAndBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":554.99999237060547,"x":1262.2669677734375,"width":367.259765625,"height":7}},{"text":"{","targetRectangle":{"y":561.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":568.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":575.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":582.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time || i == 0)","targetRectangle":{"y":596.99999237060547,"x":1262.2669677734375,"width":154.8251953125,"height":7}},{"text":"        {","targetRectangle":{"y":603.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"            const auto beatsSinceFirstBar = ((time - it.timeOfFirstBar) * it.beatsPerSecond).inBeats();","targetRectangle":{"y":610.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"            if (beatsSinceFirstBar < 0)","targetRectangle":{"y":624.99999237060547,"x":1262.2669677734375,"width":140.4228515625,"height":7}},{"text":"                return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":631.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"                         BeatDuration::fromBeats (std::fmod (std::fmod (beatsSinceFirstBar, it.numerator) + it.numerator, it.numerator)),","targetRectangle":{"y":638.99999237060547,"x":1262.2669677734375,"width":493.2802734375,"height":7}},{"text":"                         it.numerator };","targetRectangle":{"y":645.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"            return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":659.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"                     BeatDuration::fromBeats (std::fmod (beatsSinceFirstBar, it.numerator)),","targetRectangle":{"y":666.99999237060547,"x":1262.2669677734375,"width":331.25390625,"height":7}},{"text":"                     it.numerator };","targetRectangle":{"y":673.99999237060547,"x":1262.2669677734375,"width":129.62109375,"height":7}},{"text":"        }","targetRectangle":{"y":680.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"    }","targetRectangle":{"y":687.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return { 0, {} };","targetRectangle":{"y":701.99999237060547,"x":1262.2669677734375,"width":75.6123046875,"height":7}},{"text":"}","targetRectangle":{"y":708.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline Sequence::Sequence (std::vector<TempoChange> tempos, std::vector<TimeSigChange> timeSigs, std::vector<KeyChange> keys,","targetRectangle":{"y":200.30797958374023,"x":100.17655181884766,"width":346.55639648437443,"height":5}},{"text":"                           LengthOfOneBeat lengthOfOneBeat)","targetRectangle":{"y":205.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"{","targetRectangle":{"y":210.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}},{"text":"    if (keys.empty())","targetRectangle":{"y":215.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"        keys.push_back ({});","targetRectangle":{"y":220.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    assert (tempos.size() > 0 && timeSigs.size() > 0);","targetRectangle":{"y":230.30797958374023,"x":100.17655181884766,"width":149.71236328125005,"height":5}},{"text":"    assert (tempos[0].startBeat == BeatPosition());","targetRectangle":{"y":235.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"    assert (timeSigs[0].startBeat == BeatPosition());","targetRectangle":{"y":240.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    assert (keys[0].startBeat == BeatPosition());","targetRectangle":{"y":245.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"    \/\/ Find the beats with changes","targetRectangle":{"y":255.30797958374023,"x":100.17655181884766,"width":94.263339843750032,"height":5}},{"text":"    std::vector<BeatPosition> beatsWithChanges;","targetRectangle":{"y":260.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"    beatsWithChanges.reserve (tempos.size() + timeSigs.size() + keys.size());","targetRectangle":{"y":265.30797958374023,"x":100.17655181884766,"width":213.47874023437487,"height":5}},{"text":"    for (const auto& tempo : tempos)","targetRectangle":{"y":275.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"    {","targetRectangle":{"y":280.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (tempo.startBeat);","targetRectangle":{"y":285.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, tempo.startBeat.inBeats());","targetRectangle":{"y":295.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"        hash_combine (hashCode, tempo.bpm);","targetRectangle":{"y":300.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        hash_combine (hashCode, tempo.curve);","targetRectangle":{"y":305.30797958374023,"x":100.17655181884766,"width":124.7603027343751,"height":5}},{"text":"    }","targetRectangle":{"y":310.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& timeSig : timeSigs)","targetRectangle":{"y":320.30797958374023,"x":100.17655181884766,"width":110.89804687500009,"height":5}},{"text":"    {","targetRectangle":{"y":325.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (timeSig.startBeat);","targetRectangle":{"y":330.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"        hash_combine (hashCode, timeSig.startBeat.inBeats());","targetRectangle":{"y":340.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        hash_combine (hashCode, timeSig.numerator);","targetRectangle":{"y":345.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"        hash_combine (hashCode, timeSig.denominator);","targetRectangle":{"y":350.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, timeSig.triplets);","targetRectangle":{"y":355.30797958374023,"x":100.17655181884766,"width":138.62255859375009,"height":5}},{"text":"    }","targetRectangle":{"y":360.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& keyChange : keys)","targetRectangle":{"y":370.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    {","targetRectangle":{"y":375.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (keyChange.startBeat);","targetRectangle":{"y":380.30797958374023,"x":100.17655181884766,"width":158.02971679687505,"height":5}},{"text":"        hash_combine (hashCode, keyChange.startBeat.inBeats());","targetRectangle":{"y":390.30797958374023,"x":100.17655181884766,"width":174.664423828125,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.pitch);","targetRectangle":{"y":395.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.scale);","targetRectangle":{"y":400.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    }","targetRectangle":{"y":405.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    std::sort (beatsWithChanges.begin(), beatsWithChanges.end());","targetRectangle":{"y":415.30797958374023,"x":100.17655181884766,"width":180.20932617187498,"height":5}},{"text":"    beatsWithChanges.erase (std::unique (beatsWithChanges.begin(), beatsWithChanges.end()),","targetRectangle":{"y":420.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"                            beatsWithChanges.end());","targetRectangle":{"y":425.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"    \/\/ Build the sections","targetRectangle":{"y":435.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    TimePosition time;","targetRectangle":{"y":440.30797958374023,"x":100.17655181884766,"width":60.993925781249999,"height":5}},{"text":"    BeatPosition beatNum;","targetRectangle":{"y":445.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    double ppq          = 0.0;","targetRectangle":{"y":450.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"    size_t timeSigIdx   = 0;","targetRectangle":{"y":455.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t tempoIdx     = 0;","targetRectangle":{"y":460.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t keyIdx       = 0;","targetRectangle":{"y":465.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    auto currTempo   = tempos[tempoIdx++];","targetRectangle":{"y":475.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"    auto currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":480.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"    auto currKey     = keys[keyIdx++];","targetRectangle":{"y":485.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    const bool useDenominator = lengthOfOneBeat == LengthOfOneBeat::dependsOnTimeSignature;","targetRectangle":{"y":495.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"    for (size_t i = 0; i < beatsWithChanges.size(); ++i)","targetRectangle":{"y":505.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"    {","targetRectangle":{"y":510.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        const auto currentBeat = beatsWithChanges[i];","targetRectangle":{"y":515.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        assert (std::abs ((currentBeat - beatNum).inBeats()) < 0.001);","targetRectangle":{"y":520.30797958374023,"x":100.17655181884766,"width":194.07158203124993,"height":5}},{"text":"        while (tempoIdx < tempos.size() && tempos[tempoIdx].startBeat == currentBeat)","targetRectangle":{"y":530.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"            currTempo = tempos[tempoIdx++];","targetRectangle":{"y":535.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        if (timeSigIdx < timeSigs.size() && timeSigs[timeSigIdx].startBeat == currentBeat)","targetRectangle":{"y":545.30797958374023,"x":100.17655181884766,"width":249.52060546874975,"height":5}},{"text":"            currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":550.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        if (keyIdx < keys.size() && keys[keyIdx].startBeat == currentBeat)","targetRectangle":{"y":560.30797958374023,"x":100.17655181884766,"width":205.1613867187499,"height":5}},{"text":"            currKey = keys[keyIdx++];","targetRectangle":{"y":565.30797958374023,"x":100.17655181884766,"width":102.58069335937506,"height":5}},{"text":"        const bool nextTempoValid = tempoIdx < tempos.size();","targetRectangle":{"y":575.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        double bpm = nextTempoValid ? calcCurveBpm (currTempo.startBeat.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":580.30797958374023,"x":100.17655181884766,"width":307.74208007812456,"height":5}},{"text":"                                    : currTempo.bpm;","targetRectangle":{"y":585.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"        int numSubdivisions = 1;","targetRectangle":{"y":595.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"        if (nextTempoValid && (currTempo.curve != -1.0f && currTempo.curve != 1.0f))","targetRectangle":{"y":605.30797958374023,"x":100.17655181884766,"width":232.8858984374998,"height":5}},{"text":"            numSubdivisions = static_cast<int> (std::clamp (4.0 * (tempos[tempoIdx].startBeat - currentBeat).inBeats(), 1.0, 100.0));","targetRectangle":{"y":610.30797958374023,"x":100.17655181884766,"width":368.73600585937436,"height":5}},{"text":"        const auto numBeats = BeatDuration::fromBeats ((i < beatsWithChanges.size() - 1)","targetRectangle":{"y":620.30797958374023,"x":100.17655181884766,"width":243.97570312499977,"height":5}},{"text":"                                                            ? ((beatsWithChanges[i + 1] - currentBeat).inBeats() \/ (double) numSubdivisions)","targetRectangle":{"y":625.30797958374023,"x":100.17655181884766,"width":388.1431640624993,"height":5}},{"text":"                                                            : 1.0e6);","targetRectangle":{"y":630.30797958374023,"x":100.17655181884766,"width":191.29913085937494,"height":5}},{"text":"        for (int k = 0; k < numSubdivisions; ++k)","targetRectangle":{"y":640.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        {","targetRectangle":{"y":645.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"            Section it;","targetRectangle":{"y":650.30797958374023,"x":100.17655181884766,"width":63.76637695312499,"height":5}},{"text":"            it.bpm              = bpm;","targetRectangle":{"y":660.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"            it.numerator        = currTimeSig.numerator;","targetRectangle":{"y":665.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"            it.prevNumerator    = it.numerator;","targetRectangle":{"y":670.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"            it.denominator      = currTimeSig.denominator;","targetRectangle":{"y":675.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.triplets         = currTimeSig.triplets;","targetRectangle":{"y":680.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            it.startTime        = time;","targetRectangle":{"y":685.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            it.startBeat        = beatNum;","targetRectangle":{"y":690.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"            it.secondsPerBeat   = SecondsPerBeat { useDenominator ? (240.0 \/ (bpm * it.denominator))","targetRectangle":{"y":700.30797958374023,"x":100.17655181884766,"width":277.24511718749966,"height":5}},{"text":"                                                                  : (60.0 \/ bpm) };","targetRectangle":{"y":705.30797958374023,"x":100.17655181884766,"width":230.11344726562481,"height":5}},{"text":"            it.beatsPerSecond   = 1.0 \/ it.secondsPerBeat;","targetRectangle":{"y":710.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.ppqAtStart = ppq;","targetRectangle":{"y":720.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"            ppq += 4 * numBeats.inBeats() \/ it.denominator;","targetRectangle":{"y":725.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"            it.key              = currKey.key;","targetRectangle":{"y":735.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"            if (sections.empty())","targetRectangle":{"y":745.30797958374023,"x":100.17655181884766,"width":91.490888671875041,"height":5}},{"text":"            {","targetRectangle":{"y":750.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                it.barNumberOfFirstBar = 0;","targetRectangle":{"y":755.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.beatsUntilFirstBar = {};","targetRectangle":{"y":760.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.timeOfFirstBar = {};","targetRectangle":{"y":765.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            }","targetRectangle":{"y":770.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            else","targetRectangle":{"y":775.30797958374023,"x":100.17655181884766,"width":44.359218749999997,"height":5}},{"text":"            {","targetRectangle":{"y":780.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                const auto& prevSection = sections[sections.size() - 1];","targetRectangle":{"y":785.30797958374023,"x":100.17655181884766,"width":199.61648437499991,"height":5}},{"text":"                const auto beatsSincePreviousBarUntilStart = (time - prevSection.timeOfFirstBar) * prevSection.beatsPerSecond;","targetRectangle":{"y":795.30797958374023,"x":100.17655181884766,"width":349.32884765624942,"height":5}},{"text":"                const auto barsSincePrevBar = (int) std::ceil (beatsSincePreviousBarUntilStart.inBeats() \/ prevSection.numerator - 1.0e-5);","targetRectangle":{"y":800.30797958374023,"x":100.17655181884766,"width":385.3707128906243,"height":5}},{"text":"                it.barNumberOfFirstBar = prevSection.barNumberOfFirstBar + barsSincePrevBar;","targetRectangle":{"y":810.30797958374023,"x":100.17655181884766,"width":255.06550781249973,"height":5}},{"text":"                const auto beatNumInEditOfNextBar = BeatPosition::fromBeats ((int) std::lround ((prevSection.startBeat + prevSection.beatsUntilFirstBar).inBeats())","targetRectangle":{"y":820.30797958374023,"x":100.17655181884766,"width":451.90954101562409,"height":5}},{"text":"                                                                             + (barsSincePrevBar * prevSection.numerator));","targetRectangle":{"y":825.30797958374023,"x":100.17655181884766,"width":341.01149414062445,"height":5}},{"text":"                it.beatsUntilFirstBar = beatNumInEditOfNextBar - it.startBeat;","targetRectangle":{"y":835.30797958374023,"x":100.17655181884766,"width":216.25119140624986,"height":5}},{"text":"                it.timeOfFirstBar = time + it.beatsUntilFirstBar * it.secondsPerBeat;","targetRectangle":{"y":840.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"                for (int j = (int) sections.size(); --j >= 0;)","targetRectangle":{"y":850.30797958374023,"x":100.17655181884766,"width":171.89197265625,"height":5}},{"text":"                {","targetRectangle":{"y":855.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"                    auto& tempo = sections[(size_t) j];","targetRectangle":{"y":860.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"                    if (tempo.barNumberOfFirstBar < it.barNumberOfFirstBar)","targetRectangle":{"y":870.30797958374023,"x":100.17655181884766,"width":207.93383789062489,"height":5}},{"text":"                    {","targetRectangle":{"y":875.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                        it.prevNumerator = tempo.numerator;","targetRectangle":{"y":880.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"                        break;","targetRectangle":{"y":885.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"                    }","targetRectangle":{"y":890.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                }","targetRectangle":{"y":895.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"            }","targetRectangle":{"y":900.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            sections.push_back (it);","targetRectangle":{"y":910.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"            time = time + numBeats * it.secondsPerBeat;","targetRectangle":{"y":920.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            beatNum = beatNum + numBeats;","targetRectangle":{"y":925.30797958374023,"x":100.17655181884766,"width":113.67049804687508,"height":5}},{"text":"            bpm = nextTempoValid ? calcCurveBpm (beatNum.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":935.30797958374023,"x":100.17655181884766,"width":266.1553124999997,"height":5}},{"text":"                                 : currTempo.bpm;","targetRectangle":{"y":940.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        }","targetRectangle":{"y":945.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"    }","targetRectangle":{"y":950.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"}","targetRectangle":{"y":955.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"D63C5C2DC42BCAC93596A83C0C11C541"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":303,"pointY":76},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.55317307692307693,"textBaseline":0.78557638537425256,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":212,"pointY":47},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"991CAB28492072066D106A82EC1D505F"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":336.14012145996094,"pointY":618.35398864746094},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":239.85987854003906,"pointY":476.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":972,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"B5A45AA906F0BB5CB074727A7B0A4916"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":898.3973388671875,"pointY":614.35398864746094},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":210.6026611328125,"pointY":472.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":964,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F2CF5BC9921DAF75211ADE63F9F9D910"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1576.2998046875,"pointY":454.85398864746094},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":310.7001953125,"pointY":273.14601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":565,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"AB2D2B4D785DDFEC80EFE79D1E4E1EEE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1159.8861694335938,"pointY":91.900002002716064},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0","layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.64369230769230779,"textBaseline":0.95384561098538911,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":659.11383056640625,"pointY":63.099997997283936},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":65,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A35EAEFFF7FCB0BE3167DA336D4F5899"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":898.3973388671875,"pointY":614.35398864746094},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":282.1026611328125,"pointY":407.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.63968857399730727,"pointY":0.42286930638230191}},"layers":[{"animations":[{"additive":false,"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"fillMode":"both","duration":0.01,"autoreverses":false,"animations":[{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":true},"repeatCount":0,"fillMode":"both","duration":0.0001,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true},{"additive":false,"timeOffset":0,"beginTime":0.0001,"from":{"scalar":false},"repeatCount":0,"fillMode":"forwards","duration":0.0099000000000000008,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true}],"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":210.6026611328125,"pointY":472.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":964,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F2CF5BC9921DAF75211ADE63F9F9D910"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Dynamic Tempo","targetRectangle":{"y":53.599999904632568,"x":98.599999904632568,"width":416.68000015981499,"height":71.449998885393143}},{"text":"Beats <-> Time <-> Bars","targetRectangle":{"y":176.35398948192596,"x":1260.2998046875,"width":415.03999999999996,"height":52.599999189376831}},{"text":"Curve Calculations","targetRectangle":{"y":136.35398948192596,"x":681.8973388671875,"width":344.23999999999978,"height":52.599999189376831}},{"text":"Sequence Creation","targetRectangle":{"y":136.35398948192596,"x":90.640121459960938,"width":347.56,"height":52.599999189376831}},{"text":"inline double Sequence::calcCurveBpm (double beat, const TempoChange t1, const TempoChange t2)","targetRectangle":{"y":199.99999618530273,"x":685.824462890625,"width":338.455078125,"height":7}},{"text":"{","targetRectangle":{"y":206.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    const auto b1 = t1.startBeat.inBeats();","targetRectangle":{"y":213.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto b2 = t2.startBeat.inBeats();","targetRectangle":{"y":220.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto bpm1 = t1.bpm;","targetRectangle":{"y":227.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto bpm2 = t2.bpm;","targetRectangle":{"y":234.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto c = t1.curve;","targetRectangle":{"y":241.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    const auto [x, y] = getBezierPoint (b1, bpm1, b2, bpm2, c);","targetRectangle":{"y":255.99999618530273,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    if (c >= -0.5 && c <= 0.5)","targetRectangle":{"y":269.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"        return getBezierYFromX (beat,","targetRectangle":{"y":276.99999618530273,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"                                b1, bpm1, x, y, b2, bpm2);","targetRectangle":{"y":283.99999618530273,"x":685.824462890625,"width":208.833984375,"height":7}},{"text":"    double x1end = 0;","targetRectangle":{"y":297.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double x2end = 0;","targetRectangle":{"y":304.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y1end = 0;","targetRectangle":{"y":311.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y2end = 0;","targetRectangle":{"y":318.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    getBezierEnds (b1, bpm1, b2, bpm2, c,","targetRectangle":{"y":332.99999618530273,"x":685.824462890625,"width":147.6240234375,"height":7}},{"text":"                   x1end, y1end, x2end, y2end);","targetRectangle":{"y":339.99999618530273,"x":685.824462890625,"width":169.2275390625,"height":7}},{"text":"    if (beat >= b1 && beat <= x1end)","targetRectangle":{"y":353.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y1end;","targetRectangle":{"y":360.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    if (beat >= x2end && beat <= b2)","targetRectangle":{"y":374.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y2end;","targetRectangle":{"y":381.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    return getBezierYFromX (beat, x1end, y1end, x, y, x2end, y2end);","targetRectangle":{"y":395.99999618530273,"x":685.824462890625,"width":244.83984375,"height":7}},{"text":"}","targetRectangle":{"y":402.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline std::pair<double \/*x*\/, double \/*y*\/> getBezierPoint (double x1, double y1, double x2, double y2,","targetRectangle":{"y":416.99999618530273,"x":685.824462890625,"width":374.4609375,"height":7}},{"text":"                                                             double c) noexcept","targetRectangle":{"y":423.99999618530273,"x":685.824462890625,"width":284.4462890625,"height":7}},{"text":"{","targetRectangle":{"y":430.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    if (y2 > y1)","targetRectangle":{"y":437.99999618530273,"x":685.824462890625,"width":57.609375,"height":7}},{"text":"    {","targetRectangle":{"y":444.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        auto run  = x2 - x1;","targetRectangle":{"y":451.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto rise = y2 - y1;","targetRectangle":{"y":458.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto xc = x1 + run \/ 2;","targetRectangle":{"y":472.99999618530273,"x":685.824462890625,"width":111.6181640625,"height":7}},{"text":"        auto yc = y1 + rise \/ 2;","targetRectangle":{"y":479.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"        auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":493.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        auto y = yc + rise \/ 2 * -c;","targetRectangle":{"y":500.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return { x, y };","targetRectangle":{"y":514.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    }","targetRectangle":{"y":521.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    auto run  = x2 - x1;","targetRectangle":{"y":535.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto rise = y1 - y2;","targetRectangle":{"y":542.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto xc = x1 + run \/ 2;","targetRectangle":{"y":556.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    auto yc = y2 + rise \/ 2;","targetRectangle":{"y":563.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":577.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    auto y = yc - rise \/ 2 * -c;","targetRectangle":{"y":584.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    return { x, y };","targetRectangle":{"y":598.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"}","targetRectangle":{"y":605.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline void getBezierEnds (const double x1, const double y1, const double x2, const double y2, const double c,","targetRectangle":{"y":619.99999618530273,"x":685.824462890625,"width":396.064453125,"height":7}},{"text":"                           double& x1out, double& y1out, double& x2out, double& y2out) noexcept","targetRectangle":{"y":626.99999618530273,"x":685.824462890625,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":633.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    auto minic = (std::abs (c) - 0.5f) * 2.0f;","targetRectangle":{"y":640.99999618530273,"x":685.824462890625,"width":165.626953125,"height":7}},{"text":"    auto run   = minic * (x2 - x1);","targetRectangle":{"y":647.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    auto rise  = minic * ((y2 > y1) ? (y2 - y1) : (y1 - y2));","targetRectangle":{"y":654.99999618530273,"x":685.824462890625,"width":219.6357421875,"height":7}},{"text":"    if (c > 0)","targetRectangle":{"y":668.99999618530273,"x":685.824462890625,"width":50.408203125,"height":7}},{"text":"    {","targetRectangle":{"y":675.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1 + run;","targetRectangle":{"y":682.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y1out = (float) y1;","targetRectangle":{"y":689.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"        x2out = x2;","targetRectangle":{"y":703.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y2out = (float) (y1 < y2 ? (y2 - rise) : (y2 + rise));","targetRectangle":{"y":710.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"    }","targetRectangle":{"y":717.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":724.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":731.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1;","targetRectangle":{"y":738.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y1out = (float) (y1 < y2 ? (y1 + rise) : (y1 - rise));","targetRectangle":{"y":745.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"        x2out = x2 - run;","targetRectangle":{"y":759.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y2out = (float) y2;","targetRectangle":{"y":766.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    }","targetRectangle":{"y":773.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"}","targetRectangle":{"y":780.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline double getBezierYFromX (double x, double x1, double y1, double xb, double yb, double x2, double y2) noexcept","targetRectangle":{"y":794.99999618530273,"x":685.824462890625,"width":414.0673828125,"height":7}},{"text":"{","targetRectangle":{"y":801.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    \/\/ test for straight lines and bail out","targetRectangle":{"y":808.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    if (x1 == x2 || y1 == y2)","targetRectangle":{"y":815.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"        return y1;","targetRectangle":{"y":822.99999618530273,"x":685.824462890625,"width":64.810546875,"height":7}},{"text":"    \/\/ test for endpoints","targetRectangle":{"y":836.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"    if (x <= x1)  return y1;","targetRectangle":{"y":843.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    if (x >= x2)  return y2;","targetRectangle":{"y":850.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    \/\/ ok, we have a bezier curve with one control point,","targetRectangle":{"y":864.99999618530273,"x":685.824462890625,"width":205.2333984375,"height":7}},{"text":"    \/\/ we know x, we need to find y","targetRectangle":{"y":871.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    \/\/ flip the bezier equation around so its an quadratic equation","targetRectangle":{"y":885.99999618530273,"x":685.824462890625,"width":241.2392578125,"height":7}},{"text":"    auto a = x1 - 2 * xb + x2;","targetRectangle":{"y":892.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto b = -2 * x1 + 2 * xb;","targetRectangle":{"y":899.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto c = x1 - x;","targetRectangle":{"y":906.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"    \/\/ solve for t, [0..1]","targetRectangle":{"y":920.99999618530273,"x":685.824462890625,"width":93.615234375,"height":7}},{"text":"    double t;","targetRectangle":{"y":927.99999618530273,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"    if (a == 0)","targetRectangle":{"y":941.99999618530273,"x":685.824462890625,"width":54.0087890625,"height":7}},{"text":"    {","targetRectangle":{"y":948.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = -c \/ b;","targetRectangle":{"y":955.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"    }","targetRectangle":{"y":962.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":969.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":976.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = (-b + std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":983.99999618530273,"x":685.824462890625,"width":212.4345703125,"height":7}},{"text":"        if (t < 0.0f || t > 1.0f)","targetRectangle":{"y":997.99999618530273,"x":685.824462890625,"width":118.8193359375,"height":7}},{"text":"            t = (-b - std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":1004.9999961853027,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    }","targetRectangle":{"y":1011.9999961853027,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    jassert (t >= 0.0f && t <= 1.0f);","targetRectangle":{"y":1025.9999961853027,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"    \/\/ find y using the t we just found","targetRectangle":{"y":1039.9999961853027,"x":685.824462890625,"width":140.4228515625,"height":7}},{"text":"    auto y = (std::pow (1 - t, 2) * y1) + 2 * t * (1 - t) * yb + std::pow (t, 2) * y2;","targetRectangle":{"y":1046.9999961853027,"x":685.824462890625,"width":309.650390625,"height":7}},{"text":"    return y;","targetRectangle":{"y":1053.9999961853027,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"}","targetRectangle":{"y":1060.9999961853027,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline BeatPosition toBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":239.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":246.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i > 0;)","targetRectangle":{"y":253.99999237060547,"x":1262.2669677734375,"width":176.4287109375,"height":7}},{"text":"    {","targetRectangle":{"y":260.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":267.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time)","targetRectangle":{"y":281.99999237060547,"x":1262.2669677734375,"width":118.8193359375,"height":7}},{"text":"            return it.startBeat + (time - it.startTime) * it.beatsPerSecond;","targetRectangle":{"y":288.99999237060547,"x":1262.2669677734375,"width":273.64453125,"height":7}},{"text":"    }","targetRectangle":{"y":295.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":309.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startBeat + ((time - it.startTime) * it.beatsPerSecond);","targetRectangle":{"y":316.99999237060547,"x":1262.2669677734375,"width":252.041015625,"height":7}},{"text":"}","targetRectangle":{"y":323.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BeatPosition beats)","targetRectangle":{"y":337.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":344.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":351.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":358.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":365.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (toPosition (beats - it.startBeat) >= BeatPosition())","targetRectangle":{"y":379.99999237060547,"x":1262.2669677734375,"width":230.4375,"height":7}},{"text":"            return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":386.99999237060547,"x":1262.2669677734375,"width":277.2451171875,"height":7}},{"text":"    }","targetRectangle":{"y":393.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":407.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":414.99999237060547,"x":1262.2669677734375,"width":248.4404296875,"height":7}},{"text":"}","targetRectangle":{"y":421.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BarsAndBeats barsBeats)","targetRectangle":{"y":435.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"{","targetRectangle":{"y":442.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":449.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":456.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        const auto& it = sections[(size_t) i];","targetRectangle":{"y":463.99999237060547,"x":1262.2669677734375,"width":165.626953125,"height":7}},{"text":"        if (it.barNumberOfFirstBar == barsBeats.bars + 1","targetRectangle":{"y":477.99999237060547,"x":1262.2669677734375,"width":201.6328125,"height":7}},{"text":"              && barsBeats.beats.inBeats() >= it.prevNumerator - it.beatsUntilFirstBar.inBeats())","targetRectangle":{"y":484.99999237060547,"x":1262.2669677734375,"width":349.2568359375,"height":7}},{"text":"            return it.timeOfFirstBar - it.secondsPerBeat * (BeatDuration::fromBeats (it.prevNumerator) - barsBeats.beats);","targetRectangle":{"y":491.99999237060547,"x":1262.2669677734375,"width":439.271484375,"height":7}},{"text":"        if (it.barNumberOfFirstBar <= barsBeats.bars || i == 0)","targetRectangle":{"y":505.99999237060547,"x":1262.2669677734375,"width":226.8369140625,"height":7}},{"text":"            return it.timeOfFirstBar + it.secondsPerBeat * (BeatDuration::fromBeats (((barsBeats.bars - it.barNumberOfFirstBar) * it.numerator)) + barsBeats.beats);","targetRectangle":{"y":512.99999237060547,"x":1262.2669677734375,"width":590.49609375,"height":7}},{"text":"    }","targetRectangle":{"y":519.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return {};","targetRectangle":{"y":533.99999237060547,"x":1262.2669677734375,"width":50.408203125,"height":7}},{"text":"}","targetRectangle":{"y":540.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline BarsAndBeats toBarsAndBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":554.99999237060547,"x":1262.2669677734375,"width":367.259765625,"height":7}},{"text":"{","targetRectangle":{"y":561.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":568.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":575.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":582.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time || i == 0)","targetRectangle":{"y":596.99999237060547,"x":1262.2669677734375,"width":154.8251953125,"height":7}},{"text":"        {","targetRectangle":{"y":603.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"            const auto beatsSinceFirstBar = ((time - it.timeOfFirstBar) * it.beatsPerSecond).inBeats();","targetRectangle":{"y":610.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"            if (beatsSinceFirstBar < 0)","targetRectangle":{"y":624.99999237060547,"x":1262.2669677734375,"width":140.4228515625,"height":7}},{"text":"                return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":631.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"                         BeatDuration::fromBeats (std::fmod (std::fmod (beatsSinceFirstBar, it.numerator) + it.numerator, it.numerator)),","targetRectangle":{"y":638.99999237060547,"x":1262.2669677734375,"width":493.2802734375,"height":7}},{"text":"                         it.numerator };","targetRectangle":{"y":645.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"            return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":659.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"                     BeatDuration::fromBeats (std::fmod (beatsSinceFirstBar, it.numerator)),","targetRectangle":{"y":666.99999237060547,"x":1262.2669677734375,"width":331.25390625,"height":7}},{"text":"                     it.numerator };","targetRectangle":{"y":673.99999237060547,"x":1262.2669677734375,"width":129.62109375,"height":7}},{"text":"        }","targetRectangle":{"y":680.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"    }","targetRectangle":{"y":687.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return { 0, {} };","targetRectangle":{"y":701.99999237060547,"x":1262.2669677734375,"width":75.6123046875,"height":7}},{"text":"}","targetRectangle":{"y":708.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline Sequence::Sequence (std::vector<TempoChange> tempos, std::vector<TimeSigChange> timeSigs, std::vector<KeyChange> keys,","targetRectangle":{"y":200.30797958374023,"x":100.17655181884766,"width":346.55639648437443,"height":5}},{"text":"                           LengthOfOneBeat lengthOfOneBeat)","targetRectangle":{"y":205.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"{","targetRectangle":{"y":210.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}},{"text":"    if (keys.empty())","targetRectangle":{"y":215.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"        keys.push_back ({});","targetRectangle":{"y":220.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    assert (tempos.size() > 0 && timeSigs.size() > 0);","targetRectangle":{"y":230.30797958374023,"x":100.17655181884766,"width":149.71236328125005,"height":5}},{"text":"    assert (tempos[0].startBeat == BeatPosition());","targetRectangle":{"y":235.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"    assert (timeSigs[0].startBeat == BeatPosition());","targetRectangle":{"y":240.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    assert (keys[0].startBeat == BeatPosition());","targetRectangle":{"y":245.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"    \/\/ Find the beats with changes","targetRectangle":{"y":255.30797958374023,"x":100.17655181884766,"width":94.263339843750032,"height":5}},{"text":"    std::vector<BeatPosition> beatsWithChanges;","targetRectangle":{"y":260.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"    beatsWithChanges.reserve (tempos.size() + timeSigs.size() + keys.size());","targetRectangle":{"y":265.30797958374023,"x":100.17655181884766,"width":213.47874023437487,"height":5}},{"text":"    for (const auto& tempo : tempos)","targetRectangle":{"y":275.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"    {","targetRectangle":{"y":280.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (tempo.startBeat);","targetRectangle":{"y":285.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, tempo.startBeat.inBeats());","targetRectangle":{"y":295.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"        hash_combine (hashCode, tempo.bpm);","targetRectangle":{"y":300.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        hash_combine (hashCode, tempo.curve);","targetRectangle":{"y":305.30797958374023,"x":100.17655181884766,"width":124.7603027343751,"height":5}},{"text":"    }","targetRectangle":{"y":310.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& timeSig : timeSigs)","targetRectangle":{"y":320.30797958374023,"x":100.17655181884766,"width":110.89804687500009,"height":5}},{"text":"    {","targetRectangle":{"y":325.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (timeSig.startBeat);","targetRectangle":{"y":330.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"        hash_combine (hashCode, timeSig.startBeat.inBeats());","targetRectangle":{"y":340.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        hash_combine (hashCode, timeSig.numerator);","targetRectangle":{"y":345.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"        hash_combine (hashCode, timeSig.denominator);","targetRectangle":{"y":350.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, timeSig.triplets);","targetRectangle":{"y":355.30797958374023,"x":100.17655181884766,"width":138.62255859375009,"height":5}},{"text":"    }","targetRectangle":{"y":360.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& keyChange : keys)","targetRectangle":{"y":370.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    {","targetRectangle":{"y":375.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (keyChange.startBeat);","targetRectangle":{"y":380.30797958374023,"x":100.17655181884766,"width":158.02971679687505,"height":5}},{"text":"        hash_combine (hashCode, keyChange.startBeat.inBeats());","targetRectangle":{"y":390.30797958374023,"x":100.17655181884766,"width":174.664423828125,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.pitch);","targetRectangle":{"y":395.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.scale);","targetRectangle":{"y":400.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    }","targetRectangle":{"y":405.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    std::sort (beatsWithChanges.begin(), beatsWithChanges.end());","targetRectangle":{"y":415.30797958374023,"x":100.17655181884766,"width":180.20932617187498,"height":5}},{"text":"    beatsWithChanges.erase (std::unique (beatsWithChanges.begin(), beatsWithChanges.end()),","targetRectangle":{"y":420.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"                            beatsWithChanges.end());","targetRectangle":{"y":425.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"    \/\/ Build the sections","targetRectangle":{"y":435.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    TimePosition time;","targetRectangle":{"y":440.30797958374023,"x":100.17655181884766,"width":60.993925781249999,"height":5}},{"text":"    BeatPosition beatNum;","targetRectangle":{"y":445.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    double ppq          = 0.0;","targetRectangle":{"y":450.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"    size_t timeSigIdx   = 0;","targetRectangle":{"y":455.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t tempoIdx     = 0;","targetRectangle":{"y":460.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t keyIdx       = 0;","targetRectangle":{"y":465.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    auto currTempo   = tempos[tempoIdx++];","targetRectangle":{"y":475.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"    auto currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":480.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"    auto currKey     = keys[keyIdx++];","targetRectangle":{"y":485.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    const bool useDenominator = lengthOfOneBeat == LengthOfOneBeat::dependsOnTimeSignature;","targetRectangle":{"y":495.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"    for (size_t i = 0; i < beatsWithChanges.size(); ++i)","targetRectangle":{"y":505.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"    {","targetRectangle":{"y":510.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        const auto currentBeat = beatsWithChanges[i];","targetRectangle":{"y":515.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        assert (std::abs ((currentBeat - beatNum).inBeats()) < 0.001);","targetRectangle":{"y":520.30797958374023,"x":100.17655181884766,"width":194.07158203124993,"height":5}},{"text":"        while (tempoIdx < tempos.size() && tempos[tempoIdx].startBeat == currentBeat)","targetRectangle":{"y":530.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"            currTempo = tempos[tempoIdx++];","targetRectangle":{"y":535.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        if (timeSigIdx < timeSigs.size() && timeSigs[timeSigIdx].startBeat == currentBeat)","targetRectangle":{"y":545.30797958374023,"x":100.17655181884766,"width":249.52060546874975,"height":5}},{"text":"            currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":550.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        if (keyIdx < keys.size() && keys[keyIdx].startBeat == currentBeat)","targetRectangle":{"y":560.30797958374023,"x":100.17655181884766,"width":205.1613867187499,"height":5}},{"text":"            currKey = keys[keyIdx++];","targetRectangle":{"y":565.30797958374023,"x":100.17655181884766,"width":102.58069335937506,"height":5}},{"text":"        const bool nextTempoValid = tempoIdx < tempos.size();","targetRectangle":{"y":575.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        double bpm = nextTempoValid ? calcCurveBpm (currTempo.startBeat.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":580.30797958374023,"x":100.17655181884766,"width":307.74208007812456,"height":5}},{"text":"                                    : currTempo.bpm;","targetRectangle":{"y":585.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"        int numSubdivisions = 1;","targetRectangle":{"y":595.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"        if (nextTempoValid && (currTempo.curve != -1.0f && currTempo.curve != 1.0f))","targetRectangle":{"y":605.30797958374023,"x":100.17655181884766,"width":232.8858984374998,"height":5}},{"text":"            numSubdivisions = static_cast<int> (std::clamp (4.0 * (tempos[tempoIdx].startBeat - currentBeat).inBeats(), 1.0, 100.0));","targetRectangle":{"y":610.30797958374023,"x":100.17655181884766,"width":368.73600585937436,"height":5}},{"text":"        const auto numBeats = BeatDuration::fromBeats ((i < beatsWithChanges.size() - 1)","targetRectangle":{"y":620.30797958374023,"x":100.17655181884766,"width":243.97570312499977,"height":5}},{"text":"                                                            ? ((beatsWithChanges[i + 1] - currentBeat).inBeats() \/ (double) numSubdivisions)","targetRectangle":{"y":625.30797958374023,"x":100.17655181884766,"width":388.1431640624993,"height":5}},{"text":"                                                            : 1.0e6);","targetRectangle":{"y":630.30797958374023,"x":100.17655181884766,"width":191.29913085937494,"height":5}},{"text":"        for (int k = 0; k < numSubdivisions; ++k)","targetRectangle":{"y":640.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        {","targetRectangle":{"y":645.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"            Section it;","targetRectangle":{"y":650.30797958374023,"x":100.17655181884766,"width":63.76637695312499,"height":5}},{"text":"            it.bpm              = bpm;","targetRectangle":{"y":660.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"            it.numerator        = currTimeSig.numerator;","targetRectangle":{"y":665.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"            it.prevNumerator    = it.numerator;","targetRectangle":{"y":670.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"            it.denominator      = currTimeSig.denominator;","targetRectangle":{"y":675.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.triplets         = currTimeSig.triplets;","targetRectangle":{"y":680.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            it.startTime        = time;","targetRectangle":{"y":685.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            it.startBeat        = beatNum;","targetRectangle":{"y":690.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"            it.secondsPerBeat   = SecondsPerBeat { useDenominator ? (240.0 \/ (bpm * it.denominator))","targetRectangle":{"y":700.30797958374023,"x":100.17655181884766,"width":277.24511718749966,"height":5}},{"text":"                                                                  : (60.0 \/ bpm) };","targetRectangle":{"y":705.30797958374023,"x":100.17655181884766,"width":230.11344726562481,"height":5}},{"text":"            it.beatsPerSecond   = 1.0 \/ it.secondsPerBeat;","targetRectangle":{"y":710.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.ppqAtStart = ppq;","targetRectangle":{"y":720.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"            ppq += 4 * numBeats.inBeats() \/ it.denominator;","targetRectangle":{"y":725.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"            it.key              = currKey.key;","targetRectangle":{"y":735.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"            if (sections.empty())","targetRectangle":{"y":745.30797958374023,"x":100.17655181884766,"width":91.490888671875041,"height":5}},{"text":"            {","targetRectangle":{"y":750.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                it.barNumberOfFirstBar = 0;","targetRectangle":{"y":755.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.beatsUntilFirstBar = {};","targetRectangle":{"y":760.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.timeOfFirstBar = {};","targetRectangle":{"y":765.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            }","targetRectangle":{"y":770.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            else","targetRectangle":{"y":775.30797958374023,"x":100.17655181884766,"width":44.359218749999997,"height":5}},{"text":"            {","targetRectangle":{"y":780.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                const auto& prevSection = sections[sections.size() - 1];","targetRectangle":{"y":785.30797958374023,"x":100.17655181884766,"width":199.61648437499991,"height":5}},{"text":"                const auto beatsSincePreviousBarUntilStart = (time - prevSection.timeOfFirstBar) * prevSection.beatsPerSecond;","targetRectangle":{"y":795.30797958374023,"x":100.17655181884766,"width":349.32884765624942,"height":5}},{"text":"                const auto barsSincePrevBar = (int) std::ceil (beatsSincePreviousBarUntilStart.inBeats() \/ prevSection.numerator - 1.0e-5);","targetRectangle":{"y":800.30797958374023,"x":100.17655181884766,"width":385.3707128906243,"height":5}},{"text":"                it.barNumberOfFirstBar = prevSection.barNumberOfFirstBar + barsSincePrevBar;","targetRectangle":{"y":810.30797958374023,"x":100.17655181884766,"width":255.06550781249973,"height":5}},{"text":"                const auto beatNumInEditOfNextBar = BeatPosition::fromBeats ((int) std::lround ((prevSection.startBeat + prevSection.beatsUntilFirstBar).inBeats())","targetRectangle":{"y":820.30797958374023,"x":100.17655181884766,"width":451.90954101562409,"height":5}},{"text":"                                                                             + (barsSincePrevBar * prevSection.numerator));","targetRectangle":{"y":825.30797958374023,"x":100.17655181884766,"width":341.01149414062445,"height":5}},{"text":"                it.beatsUntilFirstBar = beatNumInEditOfNextBar - it.startBeat;","targetRectangle":{"y":835.30797958374023,"x":100.17655181884766,"width":216.25119140624986,"height":5}},{"text":"                it.timeOfFirstBar = time + it.beatsUntilFirstBar * it.secondsPerBeat;","targetRectangle":{"y":840.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"                for (int j = (int) sections.size(); --j >= 0;)","targetRectangle":{"y":850.30797958374023,"x":100.17655181884766,"width":171.89197265625,"height":5}},{"text":"                {","targetRectangle":{"y":855.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"                    auto& tempo = sections[(size_t) j];","targetRectangle":{"y":860.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"                    if (tempo.barNumberOfFirstBar < it.barNumberOfFirstBar)","targetRectangle":{"y":870.30797958374023,"x":100.17655181884766,"width":207.93383789062489,"height":5}},{"text":"                    {","targetRectangle":{"y":875.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                        it.prevNumerator = tempo.numerator;","targetRectangle":{"y":880.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"                        break;","targetRectangle":{"y":885.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"                    }","targetRectangle":{"y":890.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                }","targetRectangle":{"y":895.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"            }","targetRectangle":{"y":900.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            sections.push_back (it);","targetRectangle":{"y":910.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"            time = time + numBeats * it.secondsPerBeat;","targetRectangle":{"y":920.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            beatNum = beatNum + numBeats;","targetRectangle":{"y":925.30797958374023,"x":100.17655181884766,"width":113.67049804687508,"height":5}},{"text":"            bpm = nextTempoValid ? calcCurveBpm (beatNum.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":935.30797958374023,"x":100.17655181884766,"width":266.1553124999997,"height":5}},{"text":"                                 : currTempo.bpm;","targetRectangle":{"y":940.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        }","targetRectangle":{"y":945.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"    }","targetRectangle":{"y":950.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"}","targetRectangle":{"y":955.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"D63C5C2DC42BCAC93596A83C0C11C541"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":303,"pointY":76},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.55317307692307693,"textBaseline":0.78557638537425256,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":212,"pointY":47},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"991CAB28492072066D106A82EC1D505F"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":336.14012145996094,"pointY":618.35398864746094},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":239.85987854003906,"pointY":476.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"B5A45AA906F0BB5CB074727A7B0A4916"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":898.3973388671875,"pointY":614.35398864746094},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":210.6026611328125,"pointY":472.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":964,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F2CF5BC9921DAF75211ADE63F9F9D910"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1576.2998046875,"pointY":454.85398864746094},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":310.7001953125,"pointY":273.14601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":565,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"AB2D2B4D785DDFEC80EFE79D1E4E1EEE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1159.8861694335938,"pointY":91.900002002716064},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0","layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.64369230769230779,"textBaseline":0.95384561098538911,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":659.11383056640625,"pointY":63.099997997283936},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":65,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A35EAEFFF7FCB0BE3167DA336D4F5899"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1576.2998046875,"pointY":454.85398864746094},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":-296.2998046875,"pointY":367.64601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":-0.46296844482421873,"pointY":0.65070090504874167}},"layers":[{"animations":[{"additive":false,"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"fillMode":"both","duration":0.01,"autoreverses":false,"animations":[{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":true},"repeatCount":0,"fillMode":"both","duration":0.0001,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true},{"additive":false,"timeOffset":0,"beginTime":0.0001,"from":{"scalar":false},"repeatCount":0,"fillMode":"forwards","duration":0.0099000000000000008,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true}],"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":310.7001953125,"pointY":273.14601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":565,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"AB2D2B4D785DDFEC80EFE79D1E4E1EEE"}]}]},"effects":[],"duration":0.01,"type":"buildIn","attributes":{"direction":0},"name":"apple:appear","objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Dynamic Tempo","targetRectangle":{"y":53.599999904632568,"x":98.599999904632568,"width":416.68000015981499,"height":71.449998885393143}},{"text":"Beats <-> Time <-> Bars","targetRectangle":{"y":176.35398948192596,"x":1260.2998046875,"width":415.03999999999996,"height":52.599999189376831}},{"text":"Curve Calculations","targetRectangle":{"y":136.35398948192596,"x":681.8973388671875,"width":344.23999999999978,"height":52.599999189376831}},{"text":"Sequence Creation","targetRectangle":{"y":136.35398948192596,"x":90.640121459960938,"width":347.56,"height":52.599999189376831}},{"text":"inline double Sequence::calcCurveBpm (double beat, const TempoChange t1, const TempoChange t2)","targetRectangle":{"y":199.99999618530273,"x":685.824462890625,"width":338.455078125,"height":7}},{"text":"{","targetRectangle":{"y":206.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    const auto b1 = t1.startBeat.inBeats();","targetRectangle":{"y":213.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto b2 = t2.startBeat.inBeats();","targetRectangle":{"y":220.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto bpm1 = t1.bpm;","targetRectangle":{"y":227.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto bpm2 = t2.bpm;","targetRectangle":{"y":234.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto c = t1.curve;","targetRectangle":{"y":241.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    const auto [x, y] = getBezierPoint (b1, bpm1, b2, bpm2, c);","targetRectangle":{"y":255.99999618530273,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    if (c >= -0.5 && c <= 0.5)","targetRectangle":{"y":269.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"        return getBezierYFromX (beat,","targetRectangle":{"y":276.99999618530273,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"                                b1, bpm1, x, y, b2, bpm2);","targetRectangle":{"y":283.99999618530273,"x":685.824462890625,"width":208.833984375,"height":7}},{"text":"    double x1end = 0;","targetRectangle":{"y":297.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double x2end = 0;","targetRectangle":{"y":304.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y1end = 0;","targetRectangle":{"y":311.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y2end = 0;","targetRectangle":{"y":318.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    getBezierEnds (b1, bpm1, b2, bpm2, c,","targetRectangle":{"y":332.99999618530273,"x":685.824462890625,"width":147.6240234375,"height":7}},{"text":"                   x1end, y1end, x2end, y2end);","targetRectangle":{"y":339.99999618530273,"x":685.824462890625,"width":169.2275390625,"height":7}},{"text":"    if (beat >= b1 && beat <= x1end)","targetRectangle":{"y":353.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y1end;","targetRectangle":{"y":360.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    if (beat >= x2end && beat <= b2)","targetRectangle":{"y":374.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y2end;","targetRectangle":{"y":381.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    return getBezierYFromX (beat, x1end, y1end, x, y, x2end, y2end);","targetRectangle":{"y":395.99999618530273,"x":685.824462890625,"width":244.83984375,"height":7}},{"text":"}","targetRectangle":{"y":402.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline std::pair<double \/*x*\/, double \/*y*\/> getBezierPoint (double x1, double y1, double x2, double y2,","targetRectangle":{"y":416.99999618530273,"x":685.824462890625,"width":374.4609375,"height":7}},{"text":"                                                             double c) noexcept","targetRectangle":{"y":423.99999618530273,"x":685.824462890625,"width":284.4462890625,"height":7}},{"text":"{","targetRectangle":{"y":430.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    if (y2 > y1)","targetRectangle":{"y":437.99999618530273,"x":685.824462890625,"width":57.609375,"height":7}},{"text":"    {","targetRectangle":{"y":444.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        auto run  = x2 - x1;","targetRectangle":{"y":451.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto rise = y2 - y1;","targetRectangle":{"y":458.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto xc = x1 + run \/ 2;","targetRectangle":{"y":472.99999618530273,"x":685.824462890625,"width":111.6181640625,"height":7}},{"text":"        auto yc = y1 + rise \/ 2;","targetRectangle":{"y":479.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"        auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":493.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        auto y = yc + rise \/ 2 * -c;","targetRectangle":{"y":500.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return { x, y };","targetRectangle":{"y":514.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    }","targetRectangle":{"y":521.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    auto run  = x2 - x1;","targetRectangle":{"y":535.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto rise = y1 - y2;","targetRectangle":{"y":542.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto xc = x1 + run \/ 2;","targetRectangle":{"y":556.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    auto yc = y2 + rise \/ 2;","targetRectangle":{"y":563.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":577.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    auto y = yc - rise \/ 2 * -c;","targetRectangle":{"y":584.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    return { x, y };","targetRectangle":{"y":598.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"}","targetRectangle":{"y":605.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline void getBezierEnds (const double x1, const double y1, const double x2, const double y2, const double c,","targetRectangle":{"y":619.99999618530273,"x":685.824462890625,"width":396.064453125,"height":7}},{"text":"                           double& x1out, double& y1out, double& x2out, double& y2out) noexcept","targetRectangle":{"y":626.99999618530273,"x":685.824462890625,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":633.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    auto minic = (std::abs (c) - 0.5f) * 2.0f;","targetRectangle":{"y":640.99999618530273,"x":685.824462890625,"width":165.626953125,"height":7}},{"text":"    auto run   = minic * (x2 - x1);","targetRectangle":{"y":647.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    auto rise  = minic * ((y2 > y1) ? (y2 - y1) : (y1 - y2));","targetRectangle":{"y":654.99999618530273,"x":685.824462890625,"width":219.6357421875,"height":7}},{"text":"    if (c > 0)","targetRectangle":{"y":668.99999618530273,"x":685.824462890625,"width":50.408203125,"height":7}},{"text":"    {","targetRectangle":{"y":675.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1 + run;","targetRectangle":{"y":682.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y1out = (float) y1;","targetRectangle":{"y":689.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"        x2out = x2;","targetRectangle":{"y":703.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y2out = (float) (y1 < y2 ? (y2 - rise) : (y2 + rise));","targetRectangle":{"y":710.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"    }","targetRectangle":{"y":717.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":724.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":731.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1;","targetRectangle":{"y":738.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y1out = (float) (y1 < y2 ? (y1 + rise) : (y1 - rise));","targetRectangle":{"y":745.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"        x2out = x2 - run;","targetRectangle":{"y":759.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y2out = (float) y2;","targetRectangle":{"y":766.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    }","targetRectangle":{"y":773.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"}","targetRectangle":{"y":780.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline double getBezierYFromX (double x, double x1, double y1, double xb, double yb, double x2, double y2) noexcept","targetRectangle":{"y":794.99999618530273,"x":685.824462890625,"width":414.0673828125,"height":7}},{"text":"{","targetRectangle":{"y":801.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    \/\/ test for straight lines and bail out","targetRectangle":{"y":808.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    if (x1 == x2 || y1 == y2)","targetRectangle":{"y":815.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"        return y1;","targetRectangle":{"y":822.99999618530273,"x":685.824462890625,"width":64.810546875,"height":7}},{"text":"    \/\/ test for endpoints","targetRectangle":{"y":836.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"    if (x <= x1)  return y1;","targetRectangle":{"y":843.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    if (x >= x2)  return y2;","targetRectangle":{"y":850.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    \/\/ ok, we have a bezier curve with one control point,","targetRectangle":{"y":864.99999618530273,"x":685.824462890625,"width":205.2333984375,"height":7}},{"text":"    \/\/ we know x, we need to find y","targetRectangle":{"y":871.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    \/\/ flip the bezier equation around so its an quadratic equation","targetRectangle":{"y":885.99999618530273,"x":685.824462890625,"width":241.2392578125,"height":7}},{"text":"    auto a = x1 - 2 * xb + x2;","targetRectangle":{"y":892.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto b = -2 * x1 + 2 * xb;","targetRectangle":{"y":899.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto c = x1 - x;","targetRectangle":{"y":906.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"    \/\/ solve for t, [0..1]","targetRectangle":{"y":920.99999618530273,"x":685.824462890625,"width":93.615234375,"height":7}},{"text":"    double t;","targetRectangle":{"y":927.99999618530273,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"    if (a == 0)","targetRectangle":{"y":941.99999618530273,"x":685.824462890625,"width":54.0087890625,"height":7}},{"text":"    {","targetRectangle":{"y":948.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = -c \/ b;","targetRectangle":{"y":955.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"    }","targetRectangle":{"y":962.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":969.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":976.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = (-b + std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":983.99999618530273,"x":685.824462890625,"width":212.4345703125,"height":7}},{"text":"        if (t < 0.0f || t > 1.0f)","targetRectangle":{"y":997.99999618530273,"x":685.824462890625,"width":118.8193359375,"height":7}},{"text":"            t = (-b - std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":1004.9999961853027,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    }","targetRectangle":{"y":1011.9999961853027,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    jassert (t >= 0.0f && t <= 1.0f);","targetRectangle":{"y":1025.9999961853027,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"    \/\/ find y using the t we just found","targetRectangle":{"y":1039.9999961853027,"x":685.824462890625,"width":140.4228515625,"height":7}},{"text":"    auto y = (std::pow (1 - t, 2) * y1) + 2 * t * (1 - t) * yb + std::pow (t, 2) * y2;","targetRectangle":{"y":1046.9999961853027,"x":685.824462890625,"width":309.650390625,"height":7}},{"text":"    return y;","targetRectangle":{"y":1053.9999961853027,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"}","targetRectangle":{"y":1060.9999961853027,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline BeatPosition toBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":239.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":246.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i > 0;)","targetRectangle":{"y":253.99999237060547,"x":1262.2669677734375,"width":176.4287109375,"height":7}},{"text":"    {","targetRectangle":{"y":260.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":267.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time)","targetRectangle":{"y":281.99999237060547,"x":1262.2669677734375,"width":118.8193359375,"height":7}},{"text":"            return it.startBeat + (time - it.startTime) * it.beatsPerSecond;","targetRectangle":{"y":288.99999237060547,"x":1262.2669677734375,"width":273.64453125,"height":7}},{"text":"    }","targetRectangle":{"y":295.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":309.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startBeat + ((time - it.startTime) * it.beatsPerSecond);","targetRectangle":{"y":316.99999237060547,"x":1262.2669677734375,"width":252.041015625,"height":7}},{"text":"}","targetRectangle":{"y":323.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BeatPosition beats)","targetRectangle":{"y":337.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":344.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":351.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":358.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":365.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (toPosition (beats - it.startBeat) >= BeatPosition())","targetRectangle":{"y":379.99999237060547,"x":1262.2669677734375,"width":230.4375,"height":7}},{"text":"            return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":386.99999237060547,"x":1262.2669677734375,"width":277.2451171875,"height":7}},{"text":"    }","targetRectangle":{"y":393.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":407.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":414.99999237060547,"x":1262.2669677734375,"width":248.4404296875,"height":7}},{"text":"}","targetRectangle":{"y":421.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BarsAndBeats barsBeats)","targetRectangle":{"y":435.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"{","targetRectangle":{"y":442.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":449.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":456.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        const auto& it = sections[(size_t) i];","targetRectangle":{"y":463.99999237060547,"x":1262.2669677734375,"width":165.626953125,"height":7}},{"text":"        if (it.barNumberOfFirstBar == barsBeats.bars + 1","targetRectangle":{"y":477.99999237060547,"x":1262.2669677734375,"width":201.6328125,"height":7}},{"text":"              && barsBeats.beats.inBeats() >= it.prevNumerator - it.beatsUntilFirstBar.inBeats())","targetRectangle":{"y":484.99999237060547,"x":1262.2669677734375,"width":349.2568359375,"height":7}},{"text":"            return it.timeOfFirstBar - it.secondsPerBeat * (BeatDuration::fromBeats (it.prevNumerator) - barsBeats.beats);","targetRectangle":{"y":491.99999237060547,"x":1262.2669677734375,"width":439.271484375,"height":7}},{"text":"        if (it.barNumberOfFirstBar <= barsBeats.bars || i == 0)","targetRectangle":{"y":505.99999237060547,"x":1262.2669677734375,"width":226.8369140625,"height":7}},{"text":"            return it.timeOfFirstBar + it.secondsPerBeat * (BeatDuration::fromBeats (((barsBeats.bars - it.barNumberOfFirstBar) * it.numerator)) + barsBeats.beats);","targetRectangle":{"y":512.99999237060547,"x":1262.2669677734375,"width":590.49609375,"height":7}},{"text":"    }","targetRectangle":{"y":519.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return {};","targetRectangle":{"y":533.99999237060547,"x":1262.2669677734375,"width":50.408203125,"height":7}},{"text":"}","targetRectangle":{"y":540.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline BarsAndBeats toBarsAndBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":554.99999237060547,"x":1262.2669677734375,"width":367.259765625,"height":7}},{"text":"{","targetRectangle":{"y":561.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":568.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":575.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":582.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time || i == 0)","targetRectangle":{"y":596.99999237060547,"x":1262.2669677734375,"width":154.8251953125,"height":7}},{"text":"        {","targetRectangle":{"y":603.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"            const auto beatsSinceFirstBar = ((time - it.timeOfFirstBar) * it.beatsPerSecond).inBeats();","targetRectangle":{"y":610.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"            if (beatsSinceFirstBar < 0)","targetRectangle":{"y":624.99999237060547,"x":1262.2669677734375,"width":140.4228515625,"height":7}},{"text":"                return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":631.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"                         BeatDuration::fromBeats (std::fmod (std::fmod (beatsSinceFirstBar, it.numerator) + it.numerator, it.numerator)),","targetRectangle":{"y":638.99999237060547,"x":1262.2669677734375,"width":493.2802734375,"height":7}},{"text":"                         it.numerator };","targetRectangle":{"y":645.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"            return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":659.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"                     BeatDuration::fromBeats (std::fmod (beatsSinceFirstBar, it.numerator)),","targetRectangle":{"y":666.99999237060547,"x":1262.2669677734375,"width":331.25390625,"height":7}},{"text":"                     it.numerator };","targetRectangle":{"y":673.99999237060547,"x":1262.2669677734375,"width":129.62109375,"height":7}},{"text":"        }","targetRectangle":{"y":680.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"    }","targetRectangle":{"y":687.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return { 0, {} };","targetRectangle":{"y":701.99999237060547,"x":1262.2669677734375,"width":75.6123046875,"height":7}},{"text":"}","targetRectangle":{"y":708.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline Sequence::Sequence (std::vector<TempoChange> tempos, std::vector<TimeSigChange> timeSigs, std::vector<KeyChange> keys,","targetRectangle":{"y":200.30797958374023,"x":100.17655181884766,"width":346.55639648437443,"height":5}},{"text":"                           LengthOfOneBeat lengthOfOneBeat)","targetRectangle":{"y":205.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"{","targetRectangle":{"y":210.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}},{"text":"    if (keys.empty())","targetRectangle":{"y":215.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"        keys.push_back ({});","targetRectangle":{"y":220.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    assert (tempos.size() > 0 && timeSigs.size() > 0);","targetRectangle":{"y":230.30797958374023,"x":100.17655181884766,"width":149.71236328125005,"height":5}},{"text":"    assert (tempos[0].startBeat == BeatPosition());","targetRectangle":{"y":235.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"    assert (timeSigs[0].startBeat == BeatPosition());","targetRectangle":{"y":240.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    assert (keys[0].startBeat == BeatPosition());","targetRectangle":{"y":245.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"    \/\/ Find the beats with changes","targetRectangle":{"y":255.30797958374023,"x":100.17655181884766,"width":94.263339843750032,"height":5}},{"text":"    std::vector<BeatPosition> beatsWithChanges;","targetRectangle":{"y":260.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"    beatsWithChanges.reserve (tempos.size() + timeSigs.size() + keys.size());","targetRectangle":{"y":265.30797958374023,"x":100.17655181884766,"width":213.47874023437487,"height":5}},{"text":"    for (const auto& tempo : tempos)","targetRectangle":{"y":275.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"    {","targetRectangle":{"y":280.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (tempo.startBeat);","targetRectangle":{"y":285.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, tempo.startBeat.inBeats());","targetRectangle":{"y":295.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"        hash_combine (hashCode, tempo.bpm);","targetRectangle":{"y":300.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        hash_combine (hashCode, tempo.curve);","targetRectangle":{"y":305.30797958374023,"x":100.17655181884766,"width":124.7603027343751,"height":5}},{"text":"    }","targetRectangle":{"y":310.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& timeSig : timeSigs)","targetRectangle":{"y":320.30797958374023,"x":100.17655181884766,"width":110.89804687500009,"height":5}},{"text":"    {","targetRectangle":{"y":325.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (timeSig.startBeat);","targetRectangle":{"y":330.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"        hash_combine (hashCode, timeSig.startBeat.inBeats());","targetRectangle":{"y":340.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        hash_combine (hashCode, timeSig.numerator);","targetRectangle":{"y":345.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"        hash_combine (hashCode, timeSig.denominator);","targetRectangle":{"y":350.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, timeSig.triplets);","targetRectangle":{"y":355.30797958374023,"x":100.17655181884766,"width":138.62255859375009,"height":5}},{"text":"    }","targetRectangle":{"y":360.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& keyChange : keys)","targetRectangle":{"y":370.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    {","targetRectangle":{"y":375.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (keyChange.startBeat);","targetRectangle":{"y":380.30797958374023,"x":100.17655181884766,"width":158.02971679687505,"height":5}},{"text":"        hash_combine (hashCode, keyChange.startBeat.inBeats());","targetRectangle":{"y":390.30797958374023,"x":100.17655181884766,"width":174.664423828125,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.pitch);","targetRectangle":{"y":395.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.scale);","targetRectangle":{"y":400.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    }","targetRectangle":{"y":405.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    std::sort (beatsWithChanges.begin(), beatsWithChanges.end());","targetRectangle":{"y":415.30797958374023,"x":100.17655181884766,"width":180.20932617187498,"height":5}},{"text":"    beatsWithChanges.erase (std::unique (beatsWithChanges.begin(), beatsWithChanges.end()),","targetRectangle":{"y":420.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"                            beatsWithChanges.end());","targetRectangle":{"y":425.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"    \/\/ Build the sections","targetRectangle":{"y":435.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    TimePosition time;","targetRectangle":{"y":440.30797958374023,"x":100.17655181884766,"width":60.993925781249999,"height":5}},{"text":"    BeatPosition beatNum;","targetRectangle":{"y":445.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    double ppq          = 0.0;","targetRectangle":{"y":450.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"    size_t timeSigIdx   = 0;","targetRectangle":{"y":455.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t tempoIdx     = 0;","targetRectangle":{"y":460.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t keyIdx       = 0;","targetRectangle":{"y":465.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    auto currTempo   = tempos[tempoIdx++];","targetRectangle":{"y":475.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"    auto currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":480.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"    auto currKey     = keys[keyIdx++];","targetRectangle":{"y":485.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    const bool useDenominator = lengthOfOneBeat == LengthOfOneBeat::dependsOnTimeSignature;","targetRectangle":{"y":495.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"    for (size_t i = 0; i < beatsWithChanges.size(); ++i)","targetRectangle":{"y":505.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"    {","targetRectangle":{"y":510.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        const auto currentBeat = beatsWithChanges[i];","targetRectangle":{"y":515.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        assert (std::abs ((currentBeat - beatNum).inBeats()) < 0.001);","targetRectangle":{"y":520.30797958374023,"x":100.17655181884766,"width":194.07158203124993,"height":5}},{"text":"        while (tempoIdx < tempos.size() && tempos[tempoIdx].startBeat == currentBeat)","targetRectangle":{"y":530.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"            currTempo = tempos[tempoIdx++];","targetRectangle":{"y":535.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        if (timeSigIdx < timeSigs.size() && timeSigs[timeSigIdx].startBeat == currentBeat)","targetRectangle":{"y":545.30797958374023,"x":100.17655181884766,"width":249.52060546874975,"height":5}},{"text":"            currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":550.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        if (keyIdx < keys.size() && keys[keyIdx].startBeat == currentBeat)","targetRectangle":{"y":560.30797958374023,"x":100.17655181884766,"width":205.1613867187499,"height":5}},{"text":"            currKey = keys[keyIdx++];","targetRectangle":{"y":565.30797958374023,"x":100.17655181884766,"width":102.58069335937506,"height":5}},{"text":"        const bool nextTempoValid = tempoIdx < tempos.size();","targetRectangle":{"y":575.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        double bpm = nextTempoValid ? calcCurveBpm (currTempo.startBeat.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":580.30797958374023,"x":100.17655181884766,"width":307.74208007812456,"height":5}},{"text":"                                    : currTempo.bpm;","targetRectangle":{"y":585.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"        int numSubdivisions = 1;","targetRectangle":{"y":595.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"        if (nextTempoValid && (currTempo.curve != -1.0f && currTempo.curve != 1.0f))","targetRectangle":{"y":605.30797958374023,"x":100.17655181884766,"width":232.8858984374998,"height":5}},{"text":"            numSubdivisions = static_cast<int> (std::clamp (4.0 * (tempos[tempoIdx].startBeat - currentBeat).inBeats(), 1.0, 100.0));","targetRectangle":{"y":610.30797958374023,"x":100.17655181884766,"width":368.73600585937436,"height":5}},{"text":"        const auto numBeats = BeatDuration::fromBeats ((i < beatsWithChanges.size() - 1)","targetRectangle":{"y":620.30797958374023,"x":100.17655181884766,"width":243.97570312499977,"height":5}},{"text":"                                                            ? ((beatsWithChanges[i + 1] - currentBeat).inBeats() \/ (double) numSubdivisions)","targetRectangle":{"y":625.30797958374023,"x":100.17655181884766,"width":388.1431640624993,"height":5}},{"text":"                                                            : 1.0e6);","targetRectangle":{"y":630.30797958374023,"x":100.17655181884766,"width":191.29913085937494,"height":5}},{"text":"        for (int k = 0; k < numSubdivisions; ++k)","targetRectangle":{"y":640.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        {","targetRectangle":{"y":645.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"            Section it;","targetRectangle":{"y":650.30797958374023,"x":100.17655181884766,"width":63.76637695312499,"height":5}},{"text":"            it.bpm              = bpm;","targetRectangle":{"y":660.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"            it.numerator        = currTimeSig.numerator;","targetRectangle":{"y":665.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"            it.prevNumerator    = it.numerator;","targetRectangle":{"y":670.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"            it.denominator      = currTimeSig.denominator;","targetRectangle":{"y":675.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.triplets         = currTimeSig.triplets;","targetRectangle":{"y":680.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            it.startTime        = time;","targetRectangle":{"y":685.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            it.startBeat        = beatNum;","targetRectangle":{"y":690.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"            it.secondsPerBeat   = SecondsPerBeat { useDenominator ? (240.0 \/ (bpm * it.denominator))","targetRectangle":{"y":700.30797958374023,"x":100.17655181884766,"width":277.24511718749966,"height":5}},{"text":"                                                                  : (60.0 \/ bpm) };","targetRectangle":{"y":705.30797958374023,"x":100.17655181884766,"width":230.11344726562481,"height":5}},{"text":"            it.beatsPerSecond   = 1.0 \/ it.secondsPerBeat;","targetRectangle":{"y":710.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.ppqAtStart = ppq;","targetRectangle":{"y":720.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"            ppq += 4 * numBeats.inBeats() \/ it.denominator;","targetRectangle":{"y":725.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"            it.key              = currKey.key;","targetRectangle":{"y":735.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"            if (sections.empty())","targetRectangle":{"y":745.30797958374023,"x":100.17655181884766,"width":91.490888671875041,"height":5}},{"text":"            {","targetRectangle":{"y":750.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                it.barNumberOfFirstBar = 0;","targetRectangle":{"y":755.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.beatsUntilFirstBar = {};","targetRectangle":{"y":760.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.timeOfFirstBar = {};","targetRectangle":{"y":765.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            }","targetRectangle":{"y":770.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            else","targetRectangle":{"y":775.30797958374023,"x":100.17655181884766,"width":44.359218749999997,"height":5}},{"text":"            {","targetRectangle":{"y":780.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                const auto& prevSection = sections[sections.size() - 1];","targetRectangle":{"y":785.30797958374023,"x":100.17655181884766,"width":199.61648437499991,"height":5}},{"text":"                const auto beatsSincePreviousBarUntilStart = (time - prevSection.timeOfFirstBar) * prevSection.beatsPerSecond;","targetRectangle":{"y":795.30797958374023,"x":100.17655181884766,"width":349.32884765624942,"height":5}},{"text":"                const auto barsSincePrevBar = (int) std::ceil (beatsSincePreviousBarUntilStart.inBeats() \/ prevSection.numerator - 1.0e-5);","targetRectangle":{"y":800.30797958374023,"x":100.17655181884766,"width":385.3707128906243,"height":5}},{"text":"                it.barNumberOfFirstBar = prevSection.barNumberOfFirstBar + barsSincePrevBar;","targetRectangle":{"y":810.30797958374023,"x":100.17655181884766,"width":255.06550781249973,"height":5}},{"text":"                const auto beatNumInEditOfNextBar = BeatPosition::fromBeats ((int) std::lround ((prevSection.startBeat + prevSection.beatsUntilFirstBar).inBeats())","targetRectangle":{"y":820.30797958374023,"x":100.17655181884766,"width":451.90954101562409,"height":5}},{"text":"                                                                             + (barsSincePrevBar * prevSection.numerator));","targetRectangle":{"y":825.30797958374023,"x":100.17655181884766,"width":341.01149414062445,"height":5}},{"text":"                it.beatsUntilFirstBar = beatNumInEditOfNextBar - it.startBeat;","targetRectangle":{"y":835.30797958374023,"x":100.17655181884766,"width":216.25119140624986,"height":5}},{"text":"                it.timeOfFirstBar = time + it.beatsUntilFirstBar * it.secondsPerBeat;","targetRectangle":{"y":840.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"                for (int j = (int) sections.size(); --j >= 0;)","targetRectangle":{"y":850.30797958374023,"x":100.17655181884766,"width":171.89197265625,"height":5}},{"text":"                {","targetRectangle":{"y":855.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"                    auto& tempo = sections[(size_t) j];","targetRectangle":{"y":860.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"                    if (tempo.barNumberOfFirstBar < it.barNumberOfFirstBar)","targetRectangle":{"y":870.30797958374023,"x":100.17655181884766,"width":207.93383789062489,"height":5}},{"text":"                    {","targetRectangle":{"y":875.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                        it.prevNumerator = tempo.numerator;","targetRectangle":{"y":880.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"                        break;","targetRectangle":{"y":885.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"                    }","targetRectangle":{"y":890.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                }","targetRectangle":{"y":895.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"            }","targetRectangle":{"y":900.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            sections.push_back (it);","targetRectangle":{"y":910.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"            time = time + numBeats * it.secondsPerBeat;","targetRectangle":{"y":920.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            beatNum = beatNum + numBeats;","targetRectangle":{"y":925.30797958374023,"x":100.17655181884766,"width":113.67049804687508,"height":5}},{"text":"            bpm = nextTempoValid ? calcCurveBpm (beatNum.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":935.30797958374023,"x":100.17655181884766,"width":266.1553124999997,"height":5}},{"text":"                                 : currTempo.bpm;","targetRectangle":{"y":940.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        }","targetRectangle":{"y":945.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"    }","targetRectangle":{"y":950.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"}","targetRectangle":{"y":955.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"D63C5C2DC42BCAC93596A83C0C11C541"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":303,"pointY":76},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.55317307692307693,"textBaseline":0.78557638537425256,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":212,"pointY":47},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"991CAB28492072066D106A82EC1D505F"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":336.14012145996094,"pointY":618.35398864746094},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":239.85987854003906,"pointY":476.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"B5A45AA906F0BB5CB074727A7B0A4916"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":898.3973388671875,"pointY":614.35398864746094},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":210.6026611328125,"pointY":472.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F2CF5BC9921DAF75211ADE63F9F9D910"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1576.2998046875,"pointY":454.85398864746094},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":310.7001953125,"pointY":273.14601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":565,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"AB2D2B4D785DDFEC80EFE79D1E4E1EEE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1159.8861694335938,"pointY":91.900002002716064},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0","layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.64369230769230779,"textBaseline":0.95384561098538911,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":659.11383056640625,"pointY":63.099997997283936},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":65,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A35EAEFFF7FCB0BE3167DA336D4F5899"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1159.8861694335938,"pointY":91.900002002716064},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":-23.88616943359375,"pointY":480.59999799728394},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":-0.067858435890891342,"pointY":7.3938461230351376}},"layers":[{"animations":[{"additive":false,"timeOffset":0,"beginTime":1e-100,"repeatCount":0,"fillMode":"both","duration":1,"autoreverses":false,"animations":[{"repeatCount":0,"removedOnCompletion":true,"from":{"scalar":0},"timingFunction":"EaseInEaseOut","additive":false,"timeOffset":0,"autoreverses":false,"property":"opacity","fillMode":"both","duration":1,"beginTime":0,"to":{"scalar":1}},{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":false},"repeatCount":0,"fillMode":"forwards","duration":1,"autoreverses":false,"property":"hidden","to":{"scalar":false},"removedOnCompletion":true}],"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.64369230769230779,"textBaseline":0.95384561098538911,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":659.11383056640625,"pointY":63.099997997283936},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":65,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A35EAEFFF7FCB0BE3167DA336D4F5899"}]}]},"effects":[],"duration":1,"type":"buildIn","attributes":{"direction":0},"name":"com.apple.iWork.Keynote.BUKAnvil","objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Dynamic Tempo","targetRectangle":{"y":53.599999904632568,"x":98.599999904632568,"width":416.68000015981499,"height":71.449998885393143}},{"text":"Beats <-> Time <-> Bars","targetRectangle":{"y":176.35398948192596,"x":1260.2998046875,"width":415.03999999999996,"height":52.599999189376831}},{"text":"Curve Calculations","targetRectangle":{"y":136.35398948192596,"x":681.8973388671875,"width":344.23999999999978,"height":52.599999189376831}},{"text":"Sequence Creation","targetRectangle":{"y":136.35398948192596,"x":90.640121459960938,"width":347.56,"height":52.599999189376831}},{"text":"inline double Sequence::calcCurveBpm (double beat, const TempoChange t1, const TempoChange t2)","targetRectangle":{"y":199.99999618530273,"x":685.824462890625,"width":338.455078125,"height":7}},{"text":"{","targetRectangle":{"y":206.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    const auto b1 = t1.startBeat.inBeats();","targetRectangle":{"y":213.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto b2 = t2.startBeat.inBeats();","targetRectangle":{"y":220.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto bpm1 = t1.bpm;","targetRectangle":{"y":227.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto bpm2 = t2.bpm;","targetRectangle":{"y":234.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto c = t1.curve;","targetRectangle":{"y":241.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    const auto [x, y] = getBezierPoint (b1, bpm1, b2, bpm2, c);","targetRectangle":{"y":255.99999618530273,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    if (c >= -0.5 && c <= 0.5)","targetRectangle":{"y":269.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"        return getBezierYFromX (beat,","targetRectangle":{"y":276.99999618530273,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"                                b1, bpm1, x, y, b2, bpm2);","targetRectangle":{"y":283.99999618530273,"x":685.824462890625,"width":208.833984375,"height":7}},{"text":"    double x1end = 0;","targetRectangle":{"y":297.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double x2end = 0;","targetRectangle":{"y":304.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y1end = 0;","targetRectangle":{"y":311.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y2end = 0;","targetRectangle":{"y":318.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    getBezierEnds (b1, bpm1, b2, bpm2, c,","targetRectangle":{"y":332.99999618530273,"x":685.824462890625,"width":147.6240234375,"height":7}},{"text":"                   x1end, y1end, x2end, y2end);","targetRectangle":{"y":339.99999618530273,"x":685.824462890625,"width":169.2275390625,"height":7}},{"text":"    if (beat >= b1 && beat <= x1end)","targetRectangle":{"y":353.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y1end;","targetRectangle":{"y":360.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    if (beat >= x2end && beat <= b2)","targetRectangle":{"y":374.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y2end;","targetRectangle":{"y":381.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    return getBezierYFromX (beat, x1end, y1end, x, y, x2end, y2end);","targetRectangle":{"y":395.99999618530273,"x":685.824462890625,"width":244.83984375,"height":7}},{"text":"}","targetRectangle":{"y":402.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline std::pair<double \/*x*\/, double \/*y*\/> getBezierPoint (double x1, double y1, double x2, double y2,","targetRectangle":{"y":416.99999618530273,"x":685.824462890625,"width":374.4609375,"height":7}},{"text":"                                                             double c) noexcept","targetRectangle":{"y":423.99999618530273,"x":685.824462890625,"width":284.4462890625,"height":7}},{"text":"{","targetRectangle":{"y":430.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    if (y2 > y1)","targetRectangle":{"y":437.99999618530273,"x":685.824462890625,"width":57.609375,"height":7}},{"text":"    {","targetRectangle":{"y":444.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        auto run  = x2 - x1;","targetRectangle":{"y":451.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto rise = y2 - y1;","targetRectangle":{"y":458.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto xc = x1 + run \/ 2;","targetRectangle":{"y":472.99999618530273,"x":685.824462890625,"width":111.6181640625,"height":7}},{"text":"        auto yc = y1 + rise \/ 2;","targetRectangle":{"y":479.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"        auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":493.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        auto y = yc + rise \/ 2 * -c;","targetRectangle":{"y":500.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return { x, y };","targetRectangle":{"y":514.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    }","targetRectangle":{"y":521.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    auto run  = x2 - x1;","targetRectangle":{"y":535.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto rise = y1 - y2;","targetRectangle":{"y":542.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto xc = x1 + run \/ 2;","targetRectangle":{"y":556.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    auto yc = y2 + rise \/ 2;","targetRectangle":{"y":563.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":577.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    auto y = yc - rise \/ 2 * -c;","targetRectangle":{"y":584.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    return { x, y };","targetRectangle":{"y":598.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"}","targetRectangle":{"y":605.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline void getBezierEnds (const double x1, const double y1, const double x2, const double y2, const double c,","targetRectangle":{"y":619.99999618530273,"x":685.824462890625,"width":396.064453125,"height":7}},{"text":"                           double& x1out, double& y1out, double& x2out, double& y2out) noexcept","targetRectangle":{"y":626.99999618530273,"x":685.824462890625,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":633.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    auto minic = (std::abs (c) - 0.5f) * 2.0f;","targetRectangle":{"y":640.99999618530273,"x":685.824462890625,"width":165.626953125,"height":7}},{"text":"    auto run   = minic * (x2 - x1);","targetRectangle":{"y":647.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    auto rise  = minic * ((y2 > y1) ? (y2 - y1) : (y1 - y2));","targetRectangle":{"y":654.99999618530273,"x":685.824462890625,"width":219.6357421875,"height":7}},{"text":"    if (c > 0)","targetRectangle":{"y":668.99999618530273,"x":685.824462890625,"width":50.408203125,"height":7}},{"text":"    {","targetRectangle":{"y":675.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1 + run;","targetRectangle":{"y":682.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y1out = (float) y1;","targetRectangle":{"y":689.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"        x2out = x2;","targetRectangle":{"y":703.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y2out = (float) (y1 < y2 ? (y2 - rise) : (y2 + rise));","targetRectangle":{"y":710.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"    }","targetRectangle":{"y":717.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":724.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":731.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1;","targetRectangle":{"y":738.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y1out = (float) (y1 < y2 ? (y1 + rise) : (y1 - rise));","targetRectangle":{"y":745.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"        x2out = x2 - run;","targetRectangle":{"y":759.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y2out = (float) y2;","targetRectangle":{"y":766.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    }","targetRectangle":{"y":773.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"}","targetRectangle":{"y":780.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline double getBezierYFromX (double x, double x1, double y1, double xb, double yb, double x2, double y2) noexcept","targetRectangle":{"y":794.99999618530273,"x":685.824462890625,"width":414.0673828125,"height":7}},{"text":"{","targetRectangle":{"y":801.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    \/\/ test for straight lines and bail out","targetRectangle":{"y":808.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    if (x1 == x2 || y1 == y2)","targetRectangle":{"y":815.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"        return y1;","targetRectangle":{"y":822.99999618530273,"x":685.824462890625,"width":64.810546875,"height":7}},{"text":"    \/\/ test for endpoints","targetRectangle":{"y":836.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"    if (x <= x1)  return y1;","targetRectangle":{"y":843.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    if (x >= x2)  return y2;","targetRectangle":{"y":850.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    \/\/ ok, we have a bezier curve with one control point,","targetRectangle":{"y":864.99999618530273,"x":685.824462890625,"width":205.2333984375,"height":7}},{"text":"    \/\/ we know x, we need to find y","targetRectangle":{"y":871.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    \/\/ flip the bezier equation around so its an quadratic equation","targetRectangle":{"y":885.99999618530273,"x":685.824462890625,"width":241.2392578125,"height":7}},{"text":"    auto a = x1 - 2 * xb + x2;","targetRectangle":{"y":892.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto b = -2 * x1 + 2 * xb;","targetRectangle":{"y":899.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto c = x1 - x;","targetRectangle":{"y":906.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"    \/\/ solve for t, [0..1]","targetRectangle":{"y":920.99999618530273,"x":685.824462890625,"width":93.615234375,"height":7}},{"text":"    double t;","targetRectangle":{"y":927.99999618530273,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"    if (a == 0)","targetRectangle":{"y":941.99999618530273,"x":685.824462890625,"width":54.0087890625,"height":7}},{"text":"    {","targetRectangle":{"y":948.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = -c \/ b;","targetRectangle":{"y":955.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"    }","targetRectangle":{"y":962.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":969.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":976.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = (-b + std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":983.99999618530273,"x":685.824462890625,"width":212.4345703125,"height":7}},{"text":"        if (t < 0.0f || t > 1.0f)","targetRectangle":{"y":997.99999618530273,"x":685.824462890625,"width":118.8193359375,"height":7}},{"text":"            t = (-b - std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":1004.9999961853027,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    }","targetRectangle":{"y":1011.9999961853027,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    jassert (t >= 0.0f && t <= 1.0f);","targetRectangle":{"y":1025.9999961853027,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"    \/\/ find y using the t we just found","targetRectangle":{"y":1039.9999961853027,"x":685.824462890625,"width":140.4228515625,"height":7}},{"text":"    auto y = (std::pow (1 - t, 2) * y1) + 2 * t * (1 - t) * yb + std::pow (t, 2) * y2;","targetRectangle":{"y":1046.9999961853027,"x":685.824462890625,"width":309.650390625,"height":7}},{"text":"    return y;","targetRectangle":{"y":1053.9999961853027,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"}","targetRectangle":{"y":1060.9999961853027,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline BeatPosition toBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":239.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":246.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i > 0;)","targetRectangle":{"y":253.99999237060547,"x":1262.2669677734375,"width":176.4287109375,"height":7}},{"text":"    {","targetRectangle":{"y":260.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":267.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time)","targetRectangle":{"y":281.99999237060547,"x":1262.2669677734375,"width":118.8193359375,"height":7}},{"text":"            return it.startBeat + (time - it.startTime) * it.beatsPerSecond;","targetRectangle":{"y":288.99999237060547,"x":1262.2669677734375,"width":273.64453125,"height":7}},{"text":"    }","targetRectangle":{"y":295.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":309.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startBeat + ((time - it.startTime) * it.beatsPerSecond);","targetRectangle":{"y":316.99999237060547,"x":1262.2669677734375,"width":252.041015625,"height":7}},{"text":"}","targetRectangle":{"y":323.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BeatPosition beats)","targetRectangle":{"y":337.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":344.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":351.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":358.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":365.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (toPosition (beats - it.startBeat) >= BeatPosition())","targetRectangle":{"y":379.99999237060547,"x":1262.2669677734375,"width":230.4375,"height":7}},{"text":"            return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":386.99999237060547,"x":1262.2669677734375,"width":277.2451171875,"height":7}},{"text":"    }","targetRectangle":{"y":393.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":407.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":414.99999237060547,"x":1262.2669677734375,"width":248.4404296875,"height":7}},{"text":"}","targetRectangle":{"y":421.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BarsAndBeats barsBeats)","targetRectangle":{"y":435.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"{","targetRectangle":{"y":442.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":449.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":456.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        const auto& it = sections[(size_t) i];","targetRectangle":{"y":463.99999237060547,"x":1262.2669677734375,"width":165.626953125,"height":7}},{"text":"        if (it.barNumberOfFirstBar == barsBeats.bars + 1","targetRectangle":{"y":477.99999237060547,"x":1262.2669677734375,"width":201.6328125,"height":7}},{"text":"              && barsBeats.beats.inBeats() >= it.prevNumerator - it.beatsUntilFirstBar.inBeats())","targetRectangle":{"y":484.99999237060547,"x":1262.2669677734375,"width":349.2568359375,"height":7}},{"text":"            return it.timeOfFirstBar - it.secondsPerBeat * (BeatDuration::fromBeats (it.prevNumerator) - barsBeats.beats);","targetRectangle":{"y":491.99999237060547,"x":1262.2669677734375,"width":439.271484375,"height":7}},{"text":"        if (it.barNumberOfFirstBar <= barsBeats.bars || i == 0)","targetRectangle":{"y":505.99999237060547,"x":1262.2669677734375,"width":226.8369140625,"height":7}},{"text":"            return it.timeOfFirstBar + it.secondsPerBeat * (BeatDuration::fromBeats (((barsBeats.bars - it.barNumberOfFirstBar) * it.numerator)) + barsBeats.beats);","targetRectangle":{"y":512.99999237060547,"x":1262.2669677734375,"width":590.49609375,"height":7}},{"text":"    }","targetRectangle":{"y":519.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return {};","targetRectangle":{"y":533.99999237060547,"x":1262.2669677734375,"width":50.408203125,"height":7}},{"text":"}","targetRectangle":{"y":540.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline BarsAndBeats toBarsAndBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":554.99999237060547,"x":1262.2669677734375,"width":367.259765625,"height":7}},{"text":"{","targetRectangle":{"y":561.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":568.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":575.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":582.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time || i == 0)","targetRectangle":{"y":596.99999237060547,"x":1262.2669677734375,"width":154.8251953125,"height":7}},{"text":"        {","targetRectangle":{"y":603.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"            const auto beatsSinceFirstBar = ((time - it.timeOfFirstBar) * it.beatsPerSecond).inBeats();","targetRectangle":{"y":610.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"            if (beatsSinceFirstBar < 0)","targetRectangle":{"y":624.99999237060547,"x":1262.2669677734375,"width":140.4228515625,"height":7}},{"text":"                return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":631.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"                         BeatDuration::fromBeats (std::fmod (std::fmod (beatsSinceFirstBar, it.numerator) + it.numerator, it.numerator)),","targetRectangle":{"y":638.99999237060547,"x":1262.2669677734375,"width":493.2802734375,"height":7}},{"text":"                         it.numerator };","targetRectangle":{"y":645.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"            return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":659.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"                     BeatDuration::fromBeats (std::fmod (beatsSinceFirstBar, it.numerator)),","targetRectangle":{"y":666.99999237060547,"x":1262.2669677734375,"width":331.25390625,"height":7}},{"text":"                     it.numerator };","targetRectangle":{"y":673.99999237060547,"x":1262.2669677734375,"width":129.62109375,"height":7}},{"text":"        }","targetRectangle":{"y":680.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"    }","targetRectangle":{"y":687.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return { 0, {} };","targetRectangle":{"y":701.99999237060547,"x":1262.2669677734375,"width":75.6123046875,"height":7}},{"text":"}","targetRectangle":{"y":708.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline Sequence::Sequence (std::vector<TempoChange> tempos, std::vector<TimeSigChange> timeSigs, std::vector<KeyChange> keys,","targetRectangle":{"y":200.30797958374023,"x":100.17655181884766,"width":346.55639648437443,"height":5}},{"text":"                           LengthOfOneBeat lengthOfOneBeat)","targetRectangle":{"y":205.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"{","targetRectangle":{"y":210.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}},{"text":"    if (keys.empty())","targetRectangle":{"y":215.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"        keys.push_back ({});","targetRectangle":{"y":220.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    assert (tempos.size() > 0 && timeSigs.size() > 0);","targetRectangle":{"y":230.30797958374023,"x":100.17655181884766,"width":149.71236328125005,"height":5}},{"text":"    assert (tempos[0].startBeat == BeatPosition());","targetRectangle":{"y":235.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"    assert (timeSigs[0].startBeat == BeatPosition());","targetRectangle":{"y":240.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    assert (keys[0].startBeat == BeatPosition());","targetRectangle":{"y":245.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"    \/\/ Find the beats with changes","targetRectangle":{"y":255.30797958374023,"x":100.17655181884766,"width":94.263339843750032,"height":5}},{"text":"    std::vector<BeatPosition> beatsWithChanges;","targetRectangle":{"y":260.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"    beatsWithChanges.reserve (tempos.size() + timeSigs.size() + keys.size());","targetRectangle":{"y":265.30797958374023,"x":100.17655181884766,"width":213.47874023437487,"height":5}},{"text":"    for (const auto& tempo : tempos)","targetRectangle":{"y":275.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"    {","targetRectangle":{"y":280.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (tempo.startBeat);","targetRectangle":{"y":285.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, tempo.startBeat.inBeats());","targetRectangle":{"y":295.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"        hash_combine (hashCode, tempo.bpm);","targetRectangle":{"y":300.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        hash_combine (hashCode, tempo.curve);","targetRectangle":{"y":305.30797958374023,"x":100.17655181884766,"width":124.7603027343751,"height":5}},{"text":"    }","targetRectangle":{"y":310.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& timeSig : timeSigs)","targetRectangle":{"y":320.30797958374023,"x":100.17655181884766,"width":110.89804687500009,"height":5}},{"text":"    {","targetRectangle":{"y":325.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (timeSig.startBeat);","targetRectangle":{"y":330.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"        hash_combine (hashCode, timeSig.startBeat.inBeats());","targetRectangle":{"y":340.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        hash_combine (hashCode, timeSig.numerator);","targetRectangle":{"y":345.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"        hash_combine (hashCode, timeSig.denominator);","targetRectangle":{"y":350.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, timeSig.triplets);","targetRectangle":{"y":355.30797958374023,"x":100.17655181884766,"width":138.62255859375009,"height":5}},{"text":"    }","targetRectangle":{"y":360.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& keyChange : keys)","targetRectangle":{"y":370.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    {","targetRectangle":{"y":375.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (keyChange.startBeat);","targetRectangle":{"y":380.30797958374023,"x":100.17655181884766,"width":158.02971679687505,"height":5}},{"text":"        hash_combine (hashCode, keyChange.startBeat.inBeats());","targetRectangle":{"y":390.30797958374023,"x":100.17655181884766,"width":174.664423828125,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.pitch);","targetRectangle":{"y":395.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.scale);","targetRectangle":{"y":400.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    }","targetRectangle":{"y":405.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    std::sort (beatsWithChanges.begin(), beatsWithChanges.end());","targetRectangle":{"y":415.30797958374023,"x":100.17655181884766,"width":180.20932617187498,"height":5}},{"text":"    beatsWithChanges.erase (std::unique (beatsWithChanges.begin(), beatsWithChanges.end()),","targetRectangle":{"y":420.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"                            beatsWithChanges.end());","targetRectangle":{"y":425.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"    \/\/ Build the sections","targetRectangle":{"y":435.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    TimePosition time;","targetRectangle":{"y":440.30797958374023,"x":100.17655181884766,"width":60.993925781249999,"height":5}},{"text":"    BeatPosition beatNum;","targetRectangle":{"y":445.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    double ppq          = 0.0;","targetRectangle":{"y":450.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"    size_t timeSigIdx   = 0;","targetRectangle":{"y":455.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t tempoIdx     = 0;","targetRectangle":{"y":460.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t keyIdx       = 0;","targetRectangle":{"y":465.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    auto currTempo   = tempos[tempoIdx++];","targetRectangle":{"y":475.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"    auto currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":480.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"    auto currKey     = keys[keyIdx++];","targetRectangle":{"y":485.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    const bool useDenominator = lengthOfOneBeat == LengthOfOneBeat::dependsOnTimeSignature;","targetRectangle":{"y":495.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"    for (size_t i = 0; i < beatsWithChanges.size(); ++i)","targetRectangle":{"y":505.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"    {","targetRectangle":{"y":510.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        const auto currentBeat = beatsWithChanges[i];","targetRectangle":{"y":515.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        assert (std::abs ((currentBeat - beatNum).inBeats()) < 0.001);","targetRectangle":{"y":520.30797958374023,"x":100.17655181884766,"width":194.07158203124993,"height":5}},{"text":"        while (tempoIdx < tempos.size() && tempos[tempoIdx].startBeat == currentBeat)","targetRectangle":{"y":530.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"            currTempo = tempos[tempoIdx++];","targetRectangle":{"y":535.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        if (timeSigIdx < timeSigs.size() && timeSigs[timeSigIdx].startBeat == currentBeat)","targetRectangle":{"y":545.30797958374023,"x":100.17655181884766,"width":249.52060546874975,"height":5}},{"text":"            currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":550.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        if (keyIdx < keys.size() && keys[keyIdx].startBeat == currentBeat)","targetRectangle":{"y":560.30797958374023,"x":100.17655181884766,"width":205.1613867187499,"height":5}},{"text":"            currKey = keys[keyIdx++];","targetRectangle":{"y":565.30797958374023,"x":100.17655181884766,"width":102.58069335937506,"height":5}},{"text":"        const bool nextTempoValid = tempoIdx < tempos.size();","targetRectangle":{"y":575.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        double bpm = nextTempoValid ? calcCurveBpm (currTempo.startBeat.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":580.30797958374023,"x":100.17655181884766,"width":307.74208007812456,"height":5}},{"text":"                                    : currTempo.bpm;","targetRectangle":{"y":585.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"        int numSubdivisions = 1;","targetRectangle":{"y":595.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"        if (nextTempoValid && (currTempo.curve != -1.0f && currTempo.curve != 1.0f))","targetRectangle":{"y":605.30797958374023,"x":100.17655181884766,"width":232.8858984374998,"height":5}},{"text":"            numSubdivisions = static_cast<int> (std::clamp (4.0 * (tempos[tempoIdx].startBeat - currentBeat).inBeats(), 1.0, 100.0));","targetRectangle":{"y":610.30797958374023,"x":100.17655181884766,"width":368.73600585937436,"height":5}},{"text":"        const auto numBeats = BeatDuration::fromBeats ((i < beatsWithChanges.size() - 1)","targetRectangle":{"y":620.30797958374023,"x":100.17655181884766,"width":243.97570312499977,"height":5}},{"text":"                                                            ? ((beatsWithChanges[i + 1] - currentBeat).inBeats() \/ (double) numSubdivisions)","targetRectangle":{"y":625.30797958374023,"x":100.17655181884766,"width":388.1431640624993,"height":5}},{"text":"                                                            : 1.0e6);","targetRectangle":{"y":630.30797958374023,"x":100.17655181884766,"width":191.29913085937494,"height":5}},{"text":"        for (int k = 0; k < numSubdivisions; ++k)","targetRectangle":{"y":640.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        {","targetRectangle":{"y":645.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"            Section it;","targetRectangle":{"y":650.30797958374023,"x":100.17655181884766,"width":63.76637695312499,"height":5}},{"text":"            it.bpm              = bpm;","targetRectangle":{"y":660.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"            it.numerator        = currTimeSig.numerator;","targetRectangle":{"y":665.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"            it.prevNumerator    = it.numerator;","targetRectangle":{"y":670.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"            it.denominator      = currTimeSig.denominator;","targetRectangle":{"y":675.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.triplets         = currTimeSig.triplets;","targetRectangle":{"y":680.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            it.startTime        = time;","targetRectangle":{"y":685.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            it.startBeat        = beatNum;","targetRectangle":{"y":690.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"            it.secondsPerBeat   = SecondsPerBeat { useDenominator ? (240.0 \/ (bpm * it.denominator))","targetRectangle":{"y":700.30797958374023,"x":100.17655181884766,"width":277.24511718749966,"height":5}},{"text":"                                                                  : (60.0 \/ bpm) };","targetRectangle":{"y":705.30797958374023,"x":100.17655181884766,"width":230.11344726562481,"height":5}},{"text":"            it.beatsPerSecond   = 1.0 \/ it.secondsPerBeat;","targetRectangle":{"y":710.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.ppqAtStart = ppq;","targetRectangle":{"y":720.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"            ppq += 4 * numBeats.inBeats() \/ it.denominator;","targetRectangle":{"y":725.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"            it.key              = currKey.key;","targetRectangle":{"y":735.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"            if (sections.empty())","targetRectangle":{"y":745.30797958374023,"x":100.17655181884766,"width":91.490888671875041,"height":5}},{"text":"            {","targetRectangle":{"y":750.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                it.barNumberOfFirstBar = 0;","targetRectangle":{"y":755.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.beatsUntilFirstBar = {};","targetRectangle":{"y":760.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.timeOfFirstBar = {};","targetRectangle":{"y":765.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            }","targetRectangle":{"y":770.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            else","targetRectangle":{"y":775.30797958374023,"x":100.17655181884766,"width":44.359218749999997,"height":5}},{"text":"            {","targetRectangle":{"y":780.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                const auto& prevSection = sections[sections.size() - 1];","targetRectangle":{"y":785.30797958374023,"x":100.17655181884766,"width":199.61648437499991,"height":5}},{"text":"                const auto beatsSincePreviousBarUntilStart = (time - prevSection.timeOfFirstBar) * prevSection.beatsPerSecond;","targetRectangle":{"y":795.30797958374023,"x":100.17655181884766,"width":349.32884765624942,"height":5}},{"text":"                const auto barsSincePrevBar = (int) std::ceil (beatsSincePreviousBarUntilStart.inBeats() \/ prevSection.numerator - 1.0e-5);","targetRectangle":{"y":800.30797958374023,"x":100.17655181884766,"width":385.3707128906243,"height":5}},{"text":"                it.barNumberOfFirstBar = prevSection.barNumberOfFirstBar + barsSincePrevBar;","targetRectangle":{"y":810.30797958374023,"x":100.17655181884766,"width":255.06550781249973,"height":5}},{"text":"                const auto beatNumInEditOfNextBar = BeatPosition::fromBeats ((int) std::lround ((prevSection.startBeat + prevSection.beatsUntilFirstBar).inBeats())","targetRectangle":{"y":820.30797958374023,"x":100.17655181884766,"width":451.90954101562409,"height":5}},{"text":"                                                                             + (barsSincePrevBar * prevSection.numerator));","targetRectangle":{"y":825.30797958374023,"x":100.17655181884766,"width":341.01149414062445,"height":5}},{"text":"                it.beatsUntilFirstBar = beatNumInEditOfNextBar - it.startBeat;","targetRectangle":{"y":835.30797958374023,"x":100.17655181884766,"width":216.25119140624986,"height":5}},{"text":"                it.timeOfFirstBar = time + it.beatsUntilFirstBar * it.secondsPerBeat;","targetRectangle":{"y":840.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"                for (int j = (int) sections.size(); --j >= 0;)","targetRectangle":{"y":850.30797958374023,"x":100.17655181884766,"width":171.89197265625,"height":5}},{"text":"                {","targetRectangle":{"y":855.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"                    auto& tempo = sections[(size_t) j];","targetRectangle":{"y":860.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"                    if (tempo.barNumberOfFirstBar < it.barNumberOfFirstBar)","targetRectangle":{"y":870.30797958374023,"x":100.17655181884766,"width":207.93383789062489,"height":5}},{"text":"                    {","targetRectangle":{"y":875.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                        it.prevNumerator = tempo.numerator;","targetRectangle":{"y":880.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"                        break;","targetRectangle":{"y":885.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"                    }","targetRectangle":{"y":890.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                }","targetRectangle":{"y":895.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"            }","targetRectangle":{"y":900.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            sections.push_back (it);","targetRectangle":{"y":910.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"            time = time + numBeats * it.secondsPerBeat;","targetRectangle":{"y":920.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            beatNum = beatNum + numBeats;","targetRectangle":{"y":925.30797958374023,"x":100.17655181884766,"width":113.67049804687508,"height":5}},{"text":"            bpm = nextTempoValid ? calcCurveBpm (beatNum.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":935.30797958374023,"x":100.17655181884766,"width":266.1553124999997,"height":5}},{"text":"                                 : currTempo.bpm;","targetRectangle":{"y":940.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        }","targetRectangle":{"y":945.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"    }","targetRectangle":{"y":950.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"}","targetRectangle":{"y":955.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":1,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"D63C5C2DC42BCAC93596A83C0C11C541"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":303,"pointY":76},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.55317307692307693,"textBaseline":0.78557638537425256,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":212,"pointY":47},"width":416,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":52,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"991CAB28492072066D106A82EC1D505F"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":336.14012145996094,"pointY":618.35398864746094},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"2B755349-E9C0-401B-AA3D-B1E68CA9F5F9","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":239.85987854003906,"pointY":476.64601135253906},"width":499,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":972,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"B5A45AA906F0BB5CB074727A7B0A4916"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":898.3973388671875,"pointY":614.35398864746094},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"9D4FEBE1-166F-4A4F-9259-6BCCFBE0E634","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":210.6026611328125,"pointY":472.64601135253906},"width":441,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":964,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F2CF5BC9921DAF75211ADE63F9F9D910"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1576.2998046875,"pointY":454.85398864746094},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"BD9EEA1D-A8F3-4BE9-A863-D43B0ED23C79","layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":true,"singleTextureOpacity":1,"textureType":5,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":310.7001953125,"pointY":273.14601135253906},"width":640,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":565,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"AB2D2B4D785DDFEC80EFE79D1E4E1EEE"}]}]},{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":1159.8861694335938,"pointY":91.900002002716064},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":65,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"8C1E7EBA-3126-495B-96B1-14AE5312EAF0","layers":[{"animations":[],"layers":[],"texturedRectangle":{"singleTextureOpacity":1,"textXHeight":0.64369230769230779,"textBaseline":0.95384561098538911,"isBackgroundTexture":true,"isVerticalText":false,"textColor":[0.32481390237808228,0.34466239809989929,0.37378150224685669,1],"textureType":6},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":659.11383056640625,"pointY":63.099997997283936},"width":352,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":65,"hidden":true,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A35EAEFFF7FCB0BE3167DA336D4F5899"}]}]}]}},{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"39CD108B14722F87544A959452F36B3C"},{"animations":[{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":false},"repeatCount":0,"fillMode":"both","duration":0.01,"autoreverses":false,"property":"hidden","to":{"scalar":true},"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"9D18C555AF4B53CB4358DAAB26305BCB"}]}]},"effects":[],"duration":0.01,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"D: 16 5k","targetRectangle":{"y":63.400002002716064,"x":1463.4339501953125,"width":354.24000000000001,"height":106.19999837875366}},{"text":"Dynamic Tempo","targetRectangle":{"y":53.599999904632568,"x":98.599999904632568,"width":416.68000015981499,"height":71.449998885393143}},{"text":"Beats <-> Time <-> Bars","targetRectangle":{"y":176.35398948192596,"x":1260.2998046875,"width":415.03999999999996,"height":52.599999189376831}},{"text":"Curve Calculations","targetRectangle":{"y":136.35398948192596,"x":681.8973388671875,"width":344.23999999999978,"height":52.599999189376831}},{"text":"Sequence Creation","targetRectangle":{"y":136.35398948192596,"x":90.640121459960938,"width":347.56,"height":52.599999189376831}},{"text":"inline double Sequence::calcCurveBpm (double beat, const TempoChange t1, const TempoChange t2)","targetRectangle":{"y":199.99999618530273,"x":685.824462890625,"width":338.455078125,"height":7}},{"text":"{","targetRectangle":{"y":206.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    const auto b1 = t1.startBeat.inBeats();","targetRectangle":{"y":213.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto b2 = t2.startBeat.inBeats();","targetRectangle":{"y":220.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    const auto bpm1 = t1.bpm;","targetRectangle":{"y":227.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto bpm2 = t2.bpm;","targetRectangle":{"y":234.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"    const auto c = t1.curve;","targetRectangle":{"y":241.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    const auto [x, y] = getBezierPoint (b1, bpm1, b2, bpm2, c);","targetRectangle":{"y":255.99999618530273,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    if (c >= -0.5 && c <= 0.5)","targetRectangle":{"y":269.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"        return getBezierYFromX (beat,","targetRectangle":{"y":276.99999618530273,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"                                b1, bpm1, x, y, b2, bpm2);","targetRectangle":{"y":283.99999618530273,"x":685.824462890625,"width":208.833984375,"height":7}},{"text":"    double x1end = 0;","targetRectangle":{"y":297.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double x2end = 0;","targetRectangle":{"y":304.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y1end = 0;","targetRectangle":{"y":311.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    double y2end = 0;","targetRectangle":{"y":318.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    getBezierEnds (b1, bpm1, b2, bpm2, c,","targetRectangle":{"y":332.99999618530273,"x":685.824462890625,"width":147.6240234375,"height":7}},{"text":"                   x1end, y1end, x2end, y2end);","targetRectangle":{"y":339.99999618530273,"x":685.824462890625,"width":169.2275390625,"height":7}},{"text":"    if (beat >= b1 && beat <= x1end)","targetRectangle":{"y":353.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y1end;","targetRectangle":{"y":360.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    if (beat >= x2end && beat <= b2)","targetRectangle":{"y":374.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return y2end;","targetRectangle":{"y":381.99999618530273,"x":685.824462890625,"width":75.6123046875,"height":7}},{"text":"    return getBezierYFromX (beat, x1end, y1end, x, y, x2end, y2end);","targetRectangle":{"y":395.99999618530273,"x":685.824462890625,"width":244.83984375,"height":7}},{"text":"}","targetRectangle":{"y":402.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline std::pair<double \/*x*\/, double \/*y*\/> getBezierPoint (double x1, double y1, double x2, double y2,","targetRectangle":{"y":416.99999618530273,"x":685.824462890625,"width":374.4609375,"height":7}},{"text":"                                                             double c) noexcept","targetRectangle":{"y":423.99999618530273,"x":685.824462890625,"width":284.4462890625,"height":7}},{"text":"{","targetRectangle":{"y":430.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    if (y2 > y1)","targetRectangle":{"y":437.99999618530273,"x":685.824462890625,"width":57.609375,"height":7}},{"text":"    {","targetRectangle":{"y":444.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        auto run  = x2 - x1;","targetRectangle":{"y":451.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto rise = y2 - y1;","targetRectangle":{"y":458.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"        auto xc = x1 + run \/ 2;","targetRectangle":{"y":472.99999618530273,"x":685.824462890625,"width":111.6181640625,"height":7}},{"text":"        auto yc = y1 + rise \/ 2;","targetRectangle":{"y":479.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"        auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":493.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        auto y = yc + rise \/ 2 * -c;","targetRectangle":{"y":500.99999618530273,"x":685.824462890625,"width":129.62109375,"height":7}},{"text":"        return { x, y };","targetRectangle":{"y":514.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    }","targetRectangle":{"y":521.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    auto run  = x2 - x1;","targetRectangle":{"y":535.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto rise = y1 - y2;","targetRectangle":{"y":542.99999618530273,"x":685.824462890625,"width":86.4140625,"height":7}},{"text":"    auto xc = x1 + run \/ 2;","targetRectangle":{"y":556.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    auto yc = y2 + rise \/ 2;","targetRectangle":{"y":563.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    auto x = xc - run  \/ 2 * -c;","targetRectangle":{"y":577.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    auto y = yc - rise \/ 2 * -c;","targetRectangle":{"y":584.99999618530273,"x":685.824462890625,"width":115.21875,"height":7}},{"text":"    return { x, y };","targetRectangle":{"y":598.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"}","targetRectangle":{"y":605.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline void getBezierEnds (const double x1, const double y1, const double x2, const double y2, const double c,","targetRectangle":{"y":619.99999618530273,"x":685.824462890625,"width":396.064453125,"height":7}},{"text":"                           double& x1out, double& y1out, double& x2out, double& y2out) noexcept","targetRectangle":{"y":626.99999618530273,"x":685.824462890625,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":633.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    auto minic = (std::abs (c) - 0.5f) * 2.0f;","targetRectangle":{"y":640.99999618530273,"x":685.824462890625,"width":165.626953125,"height":7}},{"text":"    auto run   = minic * (x2 - x1);","targetRectangle":{"y":647.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    auto rise  = minic * ((y2 > y1) ? (y2 - y1) : (y1 - y2));","targetRectangle":{"y":654.99999618530273,"x":685.824462890625,"width":219.6357421875,"height":7}},{"text":"    if (c > 0)","targetRectangle":{"y":668.99999618530273,"x":685.824462890625,"width":50.408203125,"height":7}},{"text":"    {","targetRectangle":{"y":675.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1 + run;","targetRectangle":{"y":682.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y1out = (float) y1;","targetRectangle":{"y":689.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"        x2out = x2;","targetRectangle":{"y":703.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y2out = (float) (y1 < y2 ? (y2 - rise) : (y2 + rise));","targetRectangle":{"y":710.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"    }","targetRectangle":{"y":717.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":724.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":731.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        x1out = x1;","targetRectangle":{"y":738.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"        y1out = (float) (y1 < y2 ? (y1 + rise) : (y1 - rise));","targetRectangle":{"y":745.99999618530273,"x":685.824462890625,"width":223.236328125,"height":7}},{"text":"        x2out = x2 - run;","targetRectangle":{"y":759.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"        y2out = (float) y2;","targetRectangle":{"y":766.99999618530273,"x":685.824462890625,"width":97.2158203125,"height":7}},{"text":"    }","targetRectangle":{"y":773.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"}","targetRectangle":{"y":780.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline double getBezierYFromX (double x, double x1, double y1, double xb, double yb, double x2, double y2) noexcept","targetRectangle":{"y":794.99999618530273,"x":685.824462890625,"width":414.0673828125,"height":7}},{"text":"{","targetRectangle":{"y":801.99999618530273,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"    \/\/ test for straight lines and bail out","targetRectangle":{"y":808.99999618530273,"x":685.824462890625,"width":154.8251953125,"height":7}},{"text":"    if (x1 == x2 || y1 == y2)","targetRectangle":{"y":815.99999618530273,"x":685.824462890625,"width":104.4169921875,"height":7}},{"text":"        return y1;","targetRectangle":{"y":822.99999618530273,"x":685.824462890625,"width":64.810546875,"height":7}},{"text":"    \/\/ test for endpoints","targetRectangle":{"y":836.99999618530273,"x":685.824462890625,"width":90.0146484375,"height":7}},{"text":"    if (x <= x1)  return y1;","targetRectangle":{"y":843.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    if (x >= x2)  return y2;","targetRectangle":{"y":850.99999618530273,"x":685.824462890625,"width":100.81640625,"height":7}},{"text":"    \/\/ ok, we have a bezier curve with one control point,","targetRectangle":{"y":864.99999618530273,"x":685.824462890625,"width":205.2333984375,"height":7}},{"text":"    \/\/ we know x, we need to find y","targetRectangle":{"y":871.99999618530273,"x":685.824462890625,"width":126.0205078125,"height":7}},{"text":"    \/\/ flip the bezier equation around so its an quadratic equation","targetRectangle":{"y":885.99999618530273,"x":685.824462890625,"width":241.2392578125,"height":7}},{"text":"    auto a = x1 - 2 * xb + x2;","targetRectangle":{"y":892.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto b = -2 * x1 + 2 * xb;","targetRectangle":{"y":899.99999618530273,"x":685.824462890625,"width":108.017578125,"height":7}},{"text":"    auto c = x1 - x;","targetRectangle":{"y":906.99999618530273,"x":685.824462890625,"width":72.01171875,"height":7}},{"text":"    \/\/ solve for t, [0..1]","targetRectangle":{"y":920.99999618530273,"x":685.824462890625,"width":93.615234375,"height":7}},{"text":"    double t;","targetRectangle":{"y":927.99999618530273,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"    if (a == 0)","targetRectangle":{"y":941.99999618530273,"x":685.824462890625,"width":54.0087890625,"height":7}},{"text":"    {","targetRectangle":{"y":948.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = -c \/ b;","targetRectangle":{"y":955.99999618530273,"x":685.824462890625,"width":68.4111328125,"height":7}},{"text":"    }","targetRectangle":{"y":962.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    else","targetRectangle":{"y":969.99999618530273,"x":685.824462890625,"width":28.8046875,"height":7}},{"text":"    {","targetRectangle":{"y":976.99999618530273,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"        t = (-b + std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":983.99999618530273,"x":685.824462890625,"width":212.4345703125,"height":7}},{"text":"        if (t < 0.0f || t > 1.0f)","targetRectangle":{"y":997.99999618530273,"x":685.824462890625,"width":118.8193359375,"height":7}},{"text":"            t = (-b - std::sqrt (b * b - 4 * a * c)) \/ (2 * a);","targetRectangle":{"y":1004.9999961853027,"x":685.824462890625,"width":226.8369140625,"height":7}},{"text":"    }","targetRectangle":{"y":1011.9999961853027,"x":685.824462890625,"width":18.0029296875,"height":7}},{"text":"    jassert (t >= 0.0f && t <= 1.0f);","targetRectangle":{"y":1025.9999961853027,"x":685.824462890625,"width":133.2216796875,"height":7}},{"text":"    \/\/ find y using the t we just found","targetRectangle":{"y":1039.9999961853027,"x":685.824462890625,"width":140.4228515625,"height":7}},{"text":"    auto y = (std::pow (1 - t, 2) * y1) + 2 * t * (1 - t) * yb + std::pow (t, 2) * y2;","targetRectangle":{"y":1046.9999961853027,"x":685.824462890625,"width":309.650390625,"height":7}},{"text":"    return y;","targetRectangle":{"y":1053.9999961853027,"x":685.824462890625,"width":46.8076171875,"height":7}},{"text":"}","targetRectangle":{"y":1060.9999961853027,"x":685.824462890625,"width":3.6005859375,"height":7}},{"text":"inline BeatPosition toBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":239.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":246.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i > 0;)","targetRectangle":{"y":253.99999237060547,"x":1262.2669677734375,"width":176.4287109375,"height":7}},{"text":"    {","targetRectangle":{"y":260.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":267.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time)","targetRectangle":{"y":281.99999237060547,"x":1262.2669677734375,"width":118.8193359375,"height":7}},{"text":"            return it.startBeat + (time - it.startTime) * it.beatsPerSecond;","targetRectangle":{"y":288.99999237060547,"x":1262.2669677734375,"width":273.64453125,"height":7}},{"text":"    }","targetRectangle":{"y":295.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":309.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startBeat + ((time - it.startTime) * it.beatsPerSecond);","targetRectangle":{"y":316.99999237060547,"x":1262.2669677734375,"width":252.041015625,"height":7}},{"text":"}","targetRectangle":{"y":323.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BeatPosition beats)","targetRectangle":{"y":337.99999237060547,"x":1262.2669677734375,"width":342.0556640625,"height":7}},{"text":"{","targetRectangle":{"y":344.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":351.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":358.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":365.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (toPosition (beats - it.startBeat) >= BeatPosition())","targetRectangle":{"y":379.99999237060547,"x":1262.2669677734375,"width":230.4375,"height":7}},{"text":"            return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":386.99999237060547,"x":1262.2669677734375,"width":277.2451171875,"height":7}},{"text":"    }","targetRectangle":{"y":393.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    auto& it = sections[0];","targetRectangle":{"y":407.99999237060547,"x":1262.2669677734375,"width":97.2158203125,"height":7}},{"text":"    return it.startTime + it.secondsPerBeat * (beats - it.startBeat);","targetRectangle":{"y":414.99999237060547,"x":1262.2669677734375,"width":248.4404296875,"height":7}},{"text":"}","targetRectangle":{"y":421.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline TimePosition toTime (const std::vector<Sequence::Section>& sections, BarsAndBeats barsBeats)","targetRectangle":{"y":435.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"{","targetRectangle":{"y":442.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":449.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":456.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        const auto& it = sections[(size_t) i];","targetRectangle":{"y":463.99999237060547,"x":1262.2669677734375,"width":165.626953125,"height":7}},{"text":"        if (it.barNumberOfFirstBar == barsBeats.bars + 1","targetRectangle":{"y":477.99999237060547,"x":1262.2669677734375,"width":201.6328125,"height":7}},{"text":"              && barsBeats.beats.inBeats() >= it.prevNumerator - it.beatsUntilFirstBar.inBeats())","targetRectangle":{"y":484.99999237060547,"x":1262.2669677734375,"width":349.2568359375,"height":7}},{"text":"            return it.timeOfFirstBar - it.secondsPerBeat * (BeatDuration::fromBeats (it.prevNumerator) - barsBeats.beats);","targetRectangle":{"y":491.99999237060547,"x":1262.2669677734375,"width":439.271484375,"height":7}},{"text":"        if (it.barNumberOfFirstBar <= barsBeats.bars || i == 0)","targetRectangle":{"y":505.99999237060547,"x":1262.2669677734375,"width":226.8369140625,"height":7}},{"text":"            return it.timeOfFirstBar + it.secondsPerBeat * (BeatDuration::fromBeats (((barsBeats.bars - it.barNumberOfFirstBar) * it.numerator)) + barsBeats.beats);","targetRectangle":{"y":512.99999237060547,"x":1262.2669677734375,"width":590.49609375,"height":7}},{"text":"    }","targetRectangle":{"y":519.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return {};","targetRectangle":{"y":533.99999237060547,"x":1262.2669677734375,"width":50.408203125,"height":7}},{"text":"}","targetRectangle":{"y":540.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline BarsAndBeats toBarsAndBeats (const std::vector<Sequence::Section>& sections, TimePosition time)","targetRectangle":{"y":554.99999237060547,"x":1262.2669677734375,"width":367.259765625,"height":7}},{"text":"{","targetRectangle":{"y":561.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"    for (int i = (int) sections.size(); --i >= 0;)","targetRectangle":{"y":568.99999237060547,"x":1262.2669677734375,"width":180.029296875,"height":7}},{"text":"    {","targetRectangle":{"y":575.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"        auto& it = sections[(size_t) i];","targetRectangle":{"y":582.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"        if (it.startTime <= time || i == 0)","targetRectangle":{"y":596.99999237060547,"x":1262.2669677734375,"width":154.8251953125,"height":7}},{"text":"        {","targetRectangle":{"y":603.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"            const auto beatsSinceFirstBar = ((time - it.timeOfFirstBar) * it.beatsPerSecond).inBeats();","targetRectangle":{"y":610.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"            if (beatsSinceFirstBar < 0)","targetRectangle":{"y":624.99999237060547,"x":1262.2669677734375,"width":140.4228515625,"height":7}},{"text":"                return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":631.99999237060547,"x":1262.2669677734375,"width":370.8603515625,"height":7}},{"text":"                         BeatDuration::fromBeats (std::fmod (std::fmod (beatsSinceFirstBar, it.numerator) + it.numerator, it.numerator)),","targetRectangle":{"y":638.99999237060547,"x":1262.2669677734375,"width":493.2802734375,"height":7}},{"text":"                         it.numerator };","targetRectangle":{"y":645.99999237060547,"x":1262.2669677734375,"width":144.0234375,"height":7}},{"text":"            return { it.barNumberOfFirstBar + (int) std::floor (beatsSinceFirstBar \/ it.numerator),","targetRectangle":{"y":659.99999237060547,"x":1262.2669677734375,"width":356.4580078125,"height":7}},{"text":"                     BeatDuration::fromBeats (std::fmod (beatsSinceFirstBar, it.numerator)),","targetRectangle":{"y":666.99999237060547,"x":1262.2669677734375,"width":331.25390625,"height":7}},{"text":"                     it.numerator };","targetRectangle":{"y":673.99999237060547,"x":1262.2669677734375,"width":129.62109375,"height":7}},{"text":"        }","targetRectangle":{"y":680.99999237060547,"x":1262.2669677734375,"width":32.4052734375,"height":7}},{"text":"    }","targetRectangle":{"y":687.99999237060547,"x":1262.2669677734375,"width":18.0029296875,"height":7}},{"text":"    return { 0, {} };","targetRectangle":{"y":701.99999237060547,"x":1262.2669677734375,"width":75.6123046875,"height":7}},{"text":"}","targetRectangle":{"y":708.99999237060547,"x":1262.2669677734375,"width":3.6005859375,"height":7}},{"text":"inline Sequence::Sequence (std::vector<TempoChange> tempos, std::vector<TimeSigChange> timeSigs, std::vector<KeyChange> keys,","targetRectangle":{"y":200.30797958374023,"x":100.17655181884766,"width":346.55639648437443,"height":5}},{"text":"                           LengthOfOneBeat lengthOfOneBeat)","targetRectangle":{"y":205.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"{","targetRectangle":{"y":210.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}},{"text":"    if (keys.empty())","targetRectangle":{"y":215.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"        keys.push_back ({});","targetRectangle":{"y":220.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    assert (tempos.size() > 0 && timeSigs.size() > 0);","targetRectangle":{"y":230.30797958374023,"x":100.17655181884766,"width":149.71236328125005,"height":5}},{"text":"    assert (tempos[0].startBeat == BeatPosition());","targetRectangle":{"y":235.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"    assert (timeSigs[0].startBeat == BeatPosition());","targetRectangle":{"y":240.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    assert (keys[0].startBeat == BeatPosition());","targetRectangle":{"y":245.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"    \/\/ Find the beats with changes","targetRectangle":{"y":255.30797958374023,"x":100.17655181884766,"width":94.263339843750032,"height":5}},{"text":"    std::vector<BeatPosition> beatsWithChanges;","targetRectangle":{"y":260.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"    beatsWithChanges.reserve (tempos.size() + timeSigs.size() + keys.size());","targetRectangle":{"y":265.30797958374023,"x":100.17655181884766,"width":213.47874023437487,"height":5}},{"text":"    for (const auto& tempo : tempos)","targetRectangle":{"y":275.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"    {","targetRectangle":{"y":280.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (tempo.startBeat);","targetRectangle":{"y":285.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, tempo.startBeat.inBeats());","targetRectangle":{"y":295.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"        hash_combine (hashCode, tempo.bpm);","targetRectangle":{"y":300.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        hash_combine (hashCode, tempo.curve);","targetRectangle":{"y":305.30797958374023,"x":100.17655181884766,"width":124.7603027343751,"height":5}},{"text":"    }","targetRectangle":{"y":310.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& timeSig : timeSigs)","targetRectangle":{"y":320.30797958374023,"x":100.17655181884766,"width":110.89804687500009,"height":5}},{"text":"    {","targetRectangle":{"y":325.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (timeSig.startBeat);","targetRectangle":{"y":330.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"        hash_combine (hashCode, timeSig.startBeat.inBeats());","targetRectangle":{"y":340.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        hash_combine (hashCode, timeSig.numerator);","targetRectangle":{"y":345.30797958374023,"x":100.17655181884766,"width":141.39500976562508,"height":5}},{"text":"        hash_combine (hashCode, timeSig.denominator);","targetRectangle":{"y":350.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, timeSig.triplets);","targetRectangle":{"y":355.30797958374023,"x":100.17655181884766,"width":138.62255859375009,"height":5}},{"text":"    }","targetRectangle":{"y":360.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    for (const auto& keyChange : keys)","targetRectangle":{"y":370.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    {","targetRectangle":{"y":375.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        beatsWithChanges.push_back (keyChange.startBeat);","targetRectangle":{"y":380.30797958374023,"x":100.17655181884766,"width":158.02971679687505,"height":5}},{"text":"        hash_combine (hashCode, keyChange.startBeat.inBeats());","targetRectangle":{"y":390.30797958374023,"x":100.17655181884766,"width":174.664423828125,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.pitch);","targetRectangle":{"y":395.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        hash_combine (hashCode, keyChange.key.scale);","targetRectangle":{"y":400.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"    }","targetRectangle":{"y":405.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"    std::sort (beatsWithChanges.begin(), beatsWithChanges.end());","targetRectangle":{"y":415.30797958374023,"x":100.17655181884766,"width":180.20932617187498,"height":5}},{"text":"    beatsWithChanges.erase (std::unique (beatsWithChanges.begin(), beatsWithChanges.end()),","targetRectangle":{"y":420.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"                            beatsWithChanges.end());","targetRectangle":{"y":425.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"    \/\/ Build the sections","targetRectangle":{"y":435.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    TimePosition time;","targetRectangle":{"y":440.30797958374023,"x":100.17655181884766,"width":60.993925781249999,"height":5}},{"text":"    BeatPosition beatNum;","targetRectangle":{"y":445.30797958374023,"x":100.17655181884766,"width":69.311279296875,"height":5}},{"text":"    double ppq          = 0.0;","targetRectangle":{"y":450.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"    size_t timeSigIdx   = 0;","targetRectangle":{"y":455.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t tempoIdx     = 0;","targetRectangle":{"y":460.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    size_t keyIdx       = 0;","targetRectangle":{"y":465.30797958374023,"x":100.17655181884766,"width":77.62863281250003,"height":5}},{"text":"    auto currTempo   = tempos[tempoIdx++];","targetRectangle":{"y":475.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"    auto currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":480.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"    auto currKey     = keys[keyIdx++];","targetRectangle":{"y":485.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"    const bool useDenominator = lengthOfOneBeat == LengthOfOneBeat::dependsOnTimeSignature;","targetRectangle":{"y":495.30797958374023,"x":100.17655181884766,"width":252.29305664062474,"height":5}},{"text":"    for (size_t i = 0; i < beatsWithChanges.size(); ++i)","targetRectangle":{"y":505.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"    {","targetRectangle":{"y":510.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"        const auto currentBeat = beatsWithChanges[i];","targetRectangle":{"y":515.30797958374023,"x":100.17655181884766,"width":146.93991210937506,"height":5}},{"text":"        assert (std::abs ((currentBeat - beatNum).inBeats()) < 0.001);","targetRectangle":{"y":520.30797958374023,"x":100.17655181884766,"width":194.07158203124993,"height":5}},{"text":"        while (tempoIdx < tempos.size() && tempos[tempoIdx].startBeat == currentBeat)","targetRectangle":{"y":530.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"            currTempo = tempos[tempoIdx++];","targetRectangle":{"y":535.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"        if (timeSigIdx < timeSigs.size() && timeSigs[timeSigIdx].startBeat == currentBeat)","targetRectangle":{"y":545.30797958374023,"x":100.17655181884766,"width":249.52060546874975,"height":5}},{"text":"            currTimeSig = timeSigs[timeSigIdx++];","targetRectangle":{"y":550.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        if (keyIdx < keys.size() && keys[keyIdx].startBeat == currentBeat)","targetRectangle":{"y":560.30797958374023,"x":100.17655181884766,"width":205.1613867187499,"height":5}},{"text":"            currKey = keys[keyIdx++];","targetRectangle":{"y":565.30797958374023,"x":100.17655181884766,"width":102.58069335937506,"height":5}},{"text":"        const bool nextTempoValid = tempoIdx < tempos.size();","targetRectangle":{"y":575.30797958374023,"x":100.17655181884766,"width":169.11952148437501,"height":5}},{"text":"        double bpm = nextTempoValid ? calcCurveBpm (currTempo.startBeat.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":580.30797958374023,"x":100.17655181884766,"width":307.74208007812456,"height":5}},{"text":"                                    : currTempo.bpm;","targetRectangle":{"y":585.30797958374023,"x":100.17655181884766,"width":144.16746093750007,"height":5}},{"text":"        int numSubdivisions = 1;","targetRectangle":{"y":595.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"        if (nextTempoValid && (currTempo.curve != -1.0f && currTempo.curve != 1.0f))","targetRectangle":{"y":605.30797958374023,"x":100.17655181884766,"width":232.8858984374998,"height":5}},{"text":"            numSubdivisions = static_cast<int> (std::clamp (4.0 * (tempos[tempoIdx].startBeat - currentBeat).inBeats(), 1.0, 100.0));","targetRectangle":{"y":610.30797958374023,"x":100.17655181884766,"width":368.73600585937436,"height":5}},{"text":"        const auto numBeats = BeatDuration::fromBeats ((i < beatsWithChanges.size() - 1)","targetRectangle":{"y":620.30797958374023,"x":100.17655181884766,"width":243.97570312499977,"height":5}},{"text":"                                                            ? ((beatsWithChanges[i + 1] - currentBeat).inBeats() \/ (double) numSubdivisions)","targetRectangle":{"y":625.30797958374023,"x":100.17655181884766,"width":388.1431640624993,"height":5}},{"text":"                                                            : 1.0e6);","targetRectangle":{"y":630.30797958374023,"x":100.17655181884766,"width":191.29913085937494,"height":5}},{"text":"        for (int k = 0; k < numSubdivisions; ++k)","targetRectangle":{"y":640.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        {","targetRectangle":{"y":645.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"            Section it;","targetRectangle":{"y":650.30797958374023,"x":100.17655181884766,"width":63.76637695312499,"height":5}},{"text":"            it.bpm              = bpm;","targetRectangle":{"y":660.30797958374023,"x":100.17655181884766,"width":105.35314453125005,"height":5}},{"text":"            it.numerator        = currTimeSig.numerator;","targetRectangle":{"y":665.30797958374023,"x":100.17655181884766,"width":155.25726562500003,"height":5}},{"text":"            it.prevNumerator    = it.numerator;","targetRectangle":{"y":670.30797958374023,"x":100.17655181884766,"width":130.30520507812511,"height":5}},{"text":"            it.denominator      = currTimeSig.denominator;","targetRectangle":{"y":675.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.triplets         = currTimeSig.triplets;","targetRectangle":{"y":680.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            it.startTime        = time;","targetRectangle":{"y":685.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            it.startBeat        = beatNum;","targetRectangle":{"y":690.30797958374023,"x":100.17655181884766,"width":116.44294921875007,"height":5}},{"text":"            it.secondsPerBeat   = SecondsPerBeat { useDenominator ? (240.0 \/ (bpm * it.denominator))","targetRectangle":{"y":700.30797958374023,"x":100.17655181884766,"width":277.24511718749966,"height":5}},{"text":"                                                                  : (60.0 \/ bpm) };","targetRectangle":{"y":705.30797958374023,"x":100.17655181884766,"width":230.11344726562481,"height":5}},{"text":"            it.beatsPerSecond   = 1.0 \/ it.secondsPerBeat;","targetRectangle":{"y":710.30797958374023,"x":100.17655181884766,"width":160.80216796875004,"height":5}},{"text":"            it.ppqAtStart = ppq;","targetRectangle":{"y":720.30797958374023,"x":100.17655181884766,"width":88.71843750000005,"height":5}},{"text":"            ppq += 4 * numBeats.inBeats() \/ it.denominator;","targetRectangle":{"y":725.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"            it.key              = currKey.key;","targetRectangle":{"y":735.30797958374023,"x":100.17655181884766,"width":127.53275390625009,"height":5}},{"text":"            if (sections.empty())","targetRectangle":{"y":745.30797958374023,"x":100.17655181884766,"width":91.490888671875041,"height":5}},{"text":"            {","targetRectangle":{"y":750.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                it.barNumberOfFirstBar = 0;","targetRectangle":{"y":755.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.beatsUntilFirstBar = {};","targetRectangle":{"y":760.30797958374023,"x":100.17655181884766,"width":119.21540039062509,"height":5}},{"text":"                it.timeOfFirstBar = {};","targetRectangle":{"y":765.30797958374023,"x":100.17655181884766,"width":108.12559570312507,"height":5}},{"text":"            }","targetRectangle":{"y":770.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            else","targetRectangle":{"y":775.30797958374023,"x":100.17655181884766,"width":44.359218749999997,"height":5}},{"text":"            {","targetRectangle":{"y":780.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"                const auto& prevSection = sections[sections.size() - 1];","targetRectangle":{"y":785.30797958374023,"x":100.17655181884766,"width":199.61648437499991,"height":5}},{"text":"                const auto beatsSincePreviousBarUntilStart = (time - prevSection.timeOfFirstBar) * prevSection.beatsPerSecond;","targetRectangle":{"y":795.30797958374023,"x":100.17655181884766,"width":349.32884765624942,"height":5}},{"text":"                const auto barsSincePrevBar = (int) std::ceil (beatsSincePreviousBarUntilStart.inBeats() \/ prevSection.numerator - 1.0e-5);","targetRectangle":{"y":800.30797958374023,"x":100.17655181884766,"width":385.3707128906243,"height":5}},{"text":"                it.barNumberOfFirstBar = prevSection.barNumberOfFirstBar + barsSincePrevBar;","targetRectangle":{"y":810.30797958374023,"x":100.17655181884766,"width":255.06550781249973,"height":5}},{"text":"                const auto beatNumInEditOfNextBar = BeatPosition::fromBeats ((int) std::lround ((prevSection.startBeat + prevSection.beatsUntilFirstBar).inBeats())","targetRectangle":{"y":820.30797958374023,"x":100.17655181884766,"width":451.90954101562409,"height":5}},{"text":"                                                                             + (barsSincePrevBar * prevSection.numerator));","targetRectangle":{"y":825.30797958374023,"x":100.17655181884766,"width":341.01149414062445,"height":5}},{"text":"                it.beatsUntilFirstBar = beatNumInEditOfNextBar - it.startBeat;","targetRectangle":{"y":835.30797958374023,"x":100.17655181884766,"width":216.25119140624986,"height":5}},{"text":"                it.timeOfFirstBar = time + it.beatsUntilFirstBar * it.secondsPerBeat;","targetRectangle":{"y":840.30797958374023,"x":100.17655181884766,"width":235.6583496093748,"height":5}},{"text":"                for (int j = (int) sections.size(); --j >= 0;)","targetRectangle":{"y":850.30797958374023,"x":100.17655181884766,"width":171.89197265625,"height":5}},{"text":"                {","targetRectangle":{"y":855.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"                    auto& tempo = sections[(size_t) j];","targetRectangle":{"y":860.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"                    if (tempo.barNumberOfFirstBar < it.barNumberOfFirstBar)","targetRectangle":{"y":870.30797958374023,"x":100.17655181884766,"width":207.93383789062489,"height":5}},{"text":"                    {","targetRectangle":{"y":875.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                        it.prevNumerator = tempo.numerator;","targetRectangle":{"y":880.30797958374023,"x":100.17655181884766,"width":163.57461914062503,"height":5}},{"text":"                        break;","targetRectangle":{"y":885.30797958374023,"x":100.17655181884766,"width":83.173535156250011,"height":5}},{"text":"                    }","targetRectangle":{"y":890.30797958374023,"x":100.17655181884766,"width":58.22147460937498,"height":5}},{"text":"                }","targetRectangle":{"y":895.30797958374023,"x":100.17655181884766,"width":47.131669921875016,"height":5}},{"text":"            }","targetRectangle":{"y":900.30797958374023,"x":100.17655181884766,"width":36.041865234374995,"height":5}},{"text":"            sections.push_back (it);","targetRectangle":{"y":910.30797958374023,"x":100.17655181884766,"width":99.80824218750007,"height":5}},{"text":"            time = time + numBeats * it.secondsPerBeat;","targetRectangle":{"y":920.30797958374023,"x":100.17655181884766,"width":152.48481445312504,"height":5}},{"text":"            beatNum = beatNum + numBeats;","targetRectangle":{"y":925.30797958374023,"x":100.17655181884766,"width":113.67049804687508,"height":5}},{"text":"            bpm = nextTempoValid ? calcCurveBpm (beatNum.inBeats(), currTempo, tempos[tempoIdx])","targetRectangle":{"y":935.30797958374023,"x":100.17655181884766,"width":266.1553124999997,"height":5}},{"text":"                                 : currTempo.bpm;","targetRectangle":{"y":940.30797958374023,"x":100.17655181884766,"width":135.85010742187509,"height":5}},{"text":"        }","targetRectangle":{"y":945.30797958374023,"x":100.17655181884766,"width":24.952060546875003,"height":5}},{"text":"    }","targetRectangle":{"y":950.30797958374023,"x":100.17655181884766,"width":13.862255859374997,"height":5}},{"text":"}","targetRectangle":{"y":955.30797958374023,"x":100.17655181884766,"width":2.7724511718750051,"height":5}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"9D18C555AF4B53CB4358DAAB26305BCB"}]}]}}]}