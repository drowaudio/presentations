local_slide( {"name":"ABC19674-33DF-4DCC-805A-A762B024BF5F","json":{"assets":{"F1E0B357E431ECABB22C5C0DD29519AD":{"type":"texture","index":0,"url":{"native":"assets\/ABC19674-33DF-4DCC-805A-A762B024BF5F.pdf"},"width":1920,"height":1080},"66D6EA734294898A532A2DB312C58A6B":{"type":"texture","index":1,"url":{"native":"assets\/ABC19674-33DF-4DCC-805A-A762B024BF5F.pdf"},"width":1920,"height":1080}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"66D6EA734294898A532A2DB312C58A6B"},{"animations":[{"additive":false,"timeOffset":0,"beginTime":0,"from":{"scalar":false},"repeatCount":0,"fillMode":"both","duration":0.001,"autoreverses":false,"property":"hidden","to":{"scalar":true},"removedOnCompletion":false}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F1E0B357E431ECABB22C5C0DD29519AD"}]}]},"effects":[],"duration":0.001,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"    bool try_pop (T& v)","targetRectangle":{"y":41.743751525878906,"x":930.36968994140625,"width":179.42919921875,"height":16}},{"text":"    {","targetRectangle":{"y":57.743751525878906,"x":930.36968994140625,"width":39.00634765625,"height":16}},{"text":"        for (;;)","targetRectangle":{"y":73.743751525878906,"x":930.36968994140625,"width":124.8203125,"height":16}},{"text":"        {","targetRectangle":{"y":89.743751525878906,"x":930.36968994140625,"width":70.21142578125,"height":16}},{"text":"            size_t current_head = head.load (std::memory_order_relaxed);","targetRectangle":{"y":105.74375152587891,"x":930.36968994140625,"width":561.69140625,"height":16}},{"text":"            size_t index = current_head & (capacity - 1);","targetRectangle":{"y":121.74375152587891,"x":930.36968994140625,"width":444.67236328125,"height":16}},{"text":"            auto& slot = slots[index];","targetRectangle":{"y":137.74375152587891,"x":930.36968994140625,"width":296.4482421875,"height":16}},{"text":"            size_t seq = slot.sequence.load (std::memory_order_acquire);","targetRectangle":{"y":169.74375152587891,"x":930.36968994140625,"width":561.69140625,"height":16}},{"text":"            if (ssize_t diff = seq - (current_head + 1);","targetRectangle":{"y":201.74375152587891,"x":930.36968994140625,"width":436.87109375,"height":16}},{"text":"                diff == 0) \/\/ Slot is ready for reading","targetRectangle":{"y":217.74375152587891,"x":930.36968994140625,"width":429.06982421875,"height":16}},{"text":"            {","targetRectangle":{"y":233.74375152587891,"x":930.36968994140625,"width":101.41650390625,"height":16}},{"text":"                \/\/ Try to claim this slot","targetRectangle":{"y":249.74375152587891,"x":930.36968994140625,"width":319.85205078125,"height":16}},{"text":"                if (head.compare_exchange_weak (current_head, current_head + 1,","targetRectangle":{"y":265.74375152587891,"x":930.36968994140625,"width":616.30029296875,"height":16}},{"text":"                                                std::memory_order_relaxed,","targetRectangle":{"y":281.74375152587891,"x":930.36968994140625,"width":577.2939453125,"height":16}},{"text":"                                                std::memory_order_relaxed))","targetRectangle":{"y":297.74375152587891,"x":930.36968994140625,"width":585.09521484375,"height":16}},{"text":"                {","targetRectangle":{"y":313.74375152587891,"x":930.36968994140625,"width":132.62158203125,"height":16}},{"text":"                    \/\/ Successfully claimed, read data","targetRectangle":{"y":329.74375152587891,"x":930.36968994140625,"width":421.2685546875,"height":16}},{"text":"                    v = slot.data;","targetRectangle":{"y":345.74375152587891,"x":930.36968994140625,"width":265.2431640625,"height":16}},{"text":"                    \/\/ Mark slot as consumed and ready for writing","targetRectangle":{"y":377.74375152587891,"x":930.36968994140625,"width":514.8837890625,"height":16}},{"text":"                    slot.sequence.store (current_head + capacity, std::memory_order_release);","targetRectangle":{"y":393.74375152587891,"x":930.36968994140625,"width":725.51806640625,"height":16}},{"text":"                    return true;","targetRectangle":{"y":425.74375152587891,"x":930.36968994140625,"width":249.640625,"height":16}},{"text":"                }","targetRectangle":{"y":441.74375152587891,"x":930.36968994140625,"width":132.62158203125,"height":16}},{"text":"                \/\/ CAS failed, another consumer claimed it, retry","targetRectangle":{"y":473.74375152587891,"x":930.36968994140625,"width":507.08251953125,"height":16}},{"text":"            }","targetRectangle":{"y":489.74375152587891,"x":930.36968994140625,"width":101.41650390625,"height":16}},{"text":"            else if (diff < 0) \/\/ Queue is empty","targetRectangle":{"y":505.74375152587891,"x":930.36968994140625,"width":374.4609375,"height":16}},{"text":"            {","targetRectangle":{"y":521.74375152587891,"x":930.36968994140625,"width":101.41650390625,"height":16}},{"text":"                return false;","targetRectangle":{"y":537.74375152587891,"x":930.36968994140625,"width":226.23681640625,"height":16}},{"text":"            }","targetRectangle":{"y":553.74375152587891,"x":930.36968994140625,"width":101.41650390625,"height":16}},{"text":"            \/\/ If diff > 0, slot isn't ready yet (another consumer is reading), retry","targetRectangle":{"y":585.74375152587891,"x":930.36968994140625,"width":663.10791015625,"height":16}},{"text":"        }","targetRectangle":{"y":601.74375152587891,"x":930.36968994140625,"width":70.21142578125,"height":16}},{"text":"    }","targetRectangle":{"y":617.74375152587891,"x":930.36968994140625,"width":39.00634765625,"height":16}},{"text":"template<typename T>","targetRectangle":{"y":41.743751525878906,"x":49.902088165283203,"width":156.025390625,"height":16}},{"text":"class drow_mpmc_v6","targetRectangle":{"y":57.743751525878906,"x":49.902088165283203,"width":140.4228515625,"height":16}},{"text":"{","targetRectangle":{"y":73.743751525878906,"x":49.902088165283203,"width":7.80126953125,"height":16}},{"text":"public:","targetRectangle":{"y":89.743751525878906,"x":49.902088165283203,"width":54.60888671875,"height":16}},{"text":"    drow_mpmc_v6 (size_t capacity_)","targetRectangle":{"y":105.74375152587891,"x":49.902088165283203,"width":273.04443359375,"height":16}},{"text":"        : capacity (std::bit_ceil (capacity_)),","targetRectangle":{"y":121.74375152587891,"x":49.902088165283203,"width":366.65966796875,"height":16}},{"text":"          slots (capacity)","targetRectangle":{"y":137.74375152587891,"x":49.902088165283203,"width":202.8330078125,"height":16}},{"text":"    {","targetRectangle":{"y":153.74375152587891,"x":49.902088165283203,"width":39.00634765625,"height":16}},{"text":"        \/\/ Initialise each slot's sequence number to its index","targetRectangle":{"y":169.74375152587891,"x":49.902088165283203,"width":483.6787109375,"height":16}},{"text":"        for (size_t i = 0; i < capacity; ++i)","targetRectangle":{"y":185.74375152587891,"x":49.902088165283203,"width":351.05712890625,"height":16}},{"text":"            slots[i].sequence.store (i, std::memory_order_relaxed);","targetRectangle":{"y":201.74375152587891,"x":49.902088165283203,"width":522.68505859375,"height":16}},{"text":"    }","targetRectangle":{"y":217.74375152587891,"x":49.902088165283203,"width":39.00634765625,"height":16}},{"text":"    bool try_push (const T& v)","targetRectangle":{"y":249.74375152587891,"x":49.902088165283203,"width":234.0380859375,"height":16}},{"text":"    {","targetRectangle":{"y":265.74375152587891,"x":49.902088165283203,"width":39.00634765625,"height":16}},{"text":"        for (;;)","targetRectangle":{"y":281.74375152587891,"x":49.902088165283203,"width":124.8203125,"height":16}},{"text":"        {","targetRectangle":{"y":297.74375152587891,"x":49.902088165283203,"width":70.21142578125,"height":16}},{"text":"            size_t current_tail = tail.load (std::memory_order_relaxed);","targetRectangle":{"y":313.74375152587891,"x":49.902088165283203,"width":561.69140625,"height":16}},{"text":"            size_t index = current_tail & (capacity - 1);","targetRectangle":{"y":329.74375152587891,"x":49.902088165283203,"width":444.67236328125,"height":16}},{"text":"            auto& slot = slots[index];","targetRectangle":{"y":345.74375152587891,"x":49.902088165283203,"width":296.4482421875,"height":16}},{"text":"            size_t seq = slot.sequence.load (std::memory_order_acquire);","targetRectangle":{"y":377.74375152587891,"x":49.902088165283203,"width":561.69140625,"height":16}},{"text":"            if (ssize_t diff = seq - current_tail;","targetRectangle":{"y":409.74375152587891,"x":49.902088165283203,"width":390.0634765625,"height":16}},{"text":"                diff == 0) \/\/ Slot is ready for writing","targetRectangle":{"y":425.74375152587891,"x":49.902088165283203,"width":429.06982421875,"height":16}},{"text":"            {","targetRectangle":{"y":441.74375152587891,"x":49.902088165283203,"width":101.41650390625,"height":16}},{"text":"                \/\/ Try to claim this slot","targetRectangle":{"y":457.74375152587891,"x":49.902088165283203,"width":319.85205078125,"height":16}},{"text":"                if (tail.compare_exchange_weak (current_tail, current_tail + 1,","targetRectangle":{"y":473.74375152587891,"x":49.902088165283203,"width":616.30029296875,"height":16}},{"text":"                                                std::memory_order_relaxed,","targetRectangle":{"y":489.74375152587891,"x":49.902088165283203,"width":577.2939453125,"height":16}},{"text":"                                                std::memory_order_relaxed))","targetRectangle":{"y":505.74375152587891,"x":49.902088165283203,"width":585.09521484375,"height":16}},{"text":"                {","targetRectangle":{"y":521.74375152587891,"x":49.902088165283203,"width":132.62158203125,"height":16}},{"text":"                    \/\/ Successfully claimed, write data","targetRectangle":{"y":537.74375152587891,"x":49.902088165283203,"width":429.06982421875,"height":16}},{"text":"                    slot.data = v;","targetRectangle":{"y":553.74375152587891,"x":49.902088165283203,"width":265.2431640625,"height":16}},{"text":"                    \/\/ Mark slot as ready for reading","targetRectangle":{"y":585.74375152587891,"x":49.902088165283203,"width":413.46728515625,"height":16}},{"text":"                    slot.sequence.store (current_tail + 1, std::memory_order_release);","targetRectangle":{"y":601.74375152587891,"x":49.902088165283203,"width":670.9091796875,"height":16}},{"text":"                    return true;","targetRectangle":{"y":633.74375152587891,"x":49.902088165283203,"width":249.640625,"height":16}},{"text":"                }","targetRectangle":{"y":649.74375152587891,"x":49.902088165283203,"width":132.62158203125,"height":16}},{"text":"                \/\/ CAS failed, another producer claimed it, retry","targetRectangle":{"y":681.74375152587891,"x":49.902088165283203,"width":507.08251953125,"height":16}},{"text":"            }","targetRectangle":{"y":697.74375152587891,"x":49.902088165283203,"width":101.41650390625,"height":16}},{"text":"            else if (diff < 0) \/\/ Queue is full (slot hasn't been consumed yet)","targetRectangle":{"y":713.74375152587891,"x":49.902088165283203,"width":616.30029296875,"height":16}},{"text":"            {","targetRectangle":{"y":729.74375152587891,"x":49.902088165283203,"width":101.41650390625,"height":16}},{"text":"                return false;","targetRectangle":{"y":745.74375152587891,"x":49.902088165283203,"width":226.23681640625,"height":16}},{"text":"            }","targetRectangle":{"y":761.74375152587891,"x":49.902088165283203,"width":101.41650390625,"height":16}},{"text":"            \/\/ If diff > 0, slot isn't ready yet (another producer is writing), retry","targetRectangle":{"y":793.74375152587891,"x":49.902088165283203,"width":663.10791015625,"height":16}},{"text":"        }","targetRectangle":{"y":809.74375152587891,"x":49.902088165283203,"width":70.21142578125,"height":16}},{"text":"    }","targetRectangle":{"y":825.74375152587891,"x":49.902088165283203,"width":39.00634765625,"height":16}},{"text":"private:","targetRectangle":{"y":857.74375152587891,"x":49.902088165283203,"width":62.41015625,"height":16}},{"text":"    struct slot","targetRectangle":{"y":873.74375152587891,"x":49.902088165283203,"width":117.01904296875,"height":16}},{"text":"    {","targetRectangle":{"y":889.74375152587891,"x":49.902088165283203,"width":39.00634765625,"height":16}},{"text":"        std::atomic<size_t> sequence;","targetRectangle":{"y":905.74375152587891,"x":49.902088165283203,"width":288.64697265625,"height":16}},{"text":"        T data;","targetRectangle":{"y":921.74375152587891,"x":49.902088165283203,"width":117.01904296875,"height":16}},{"text":"    };","targetRectangle":{"y":937.74375152587891,"x":49.902088165283203,"width":46.8076171875,"height":16}},{"text":"    size_t capacity = 0;","targetRectangle":{"y":969.74375152587891,"x":49.902088165283203,"width":187.23046875,"height":16}},{"text":"    alignas(hardware_destructive_interference_size) std::atomic<size_t> head { 0 };","targetRectangle":{"y":985.74375152587891,"x":49.902088165283203,"width":647.50537109375,"height":16}},{"text":"    alignas(hardware_destructive_interference_size) std::atomic<size_t> tail { 0 };","targetRectangle":{"y":1001.7437515258789,"x":49.902088165283203,"width":647.50537109375,"height":16}},{"text":"    std::vector<slot> slots;","targetRectangle":{"y":1017.7437515258789,"x":49.902088165283203,"width":218.435546875,"height":16}},{"text":"};","targetRectangle":{"y":1033.7437515258789,"x":49.902088165283203,"width":15.6025390625,"height":16}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00035007912466775983,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":960,"pointY":540},"width":1920,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":1080,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"F1E0B357E431ECABB22C5C0DD29519AD"}]}]}}]}} )